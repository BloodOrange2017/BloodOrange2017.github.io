<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="索引（Index）是帮助MySQL高效获取数据的数据结构。提取句子主干，就可以得到索引的本质：索引是数据结构。                  从MySQL逻辑架构来看，MySQL有三层架构，第一层连接，第二层查询解析、分析、优化、视图、缓存，第三层，存储引擎。        索引通过分开查询片，节省了扫描查找时间，大大提升查询效率。  大部分数据库系统及文件系统都采用B-Tree或其变种B+T">
<meta property="og:type" content="article">
<meta property="og:title" content="转载:MySQL索引之哈希索引和自适应哈希索引（Adaptive Hash Index）">
<meta property="og:url" content="https://bloodorange2017.github.io/archives/2018/03/05/mysql-index/index.html">
<meta property="og:site_name" content="XueCheng Notes">
<meta property="og:description" content="索引（Index）是帮助MySQL高效获取数据的数据结构。提取句子主干，就可以得到索引的本质：索引是数据结构。                  从MySQL逻辑架构来看，MySQL有三层架构，第一层连接，第二层查询解析、分析、优化、视图、缓存，第三层，存储引擎。        索引通过分开查询片，节省了扫描查找时间，大大提升查询效率。  大部分数据库系统及文件系统都采用B-Tree或其变种B+T">
<meta property="og:image" content="http://xiaocao.u.qiniudn.com/blog/2015-09-13-mysql-hash-index-mysql-design.png">
<meta property="og:image" content="http://img.blog.csdn.net/20150707113055755?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center">
<meta property="og:image" content="http://img.blog.csdn.net/20150707113158731?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center">
<meta property="og:image" content="http://img.blog.csdn.net/20150707113246099?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center">
<meta property="og:image" content="http://img.blog.csdn.net/20150708144647587?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center">
<meta property="og:image" content="http://images2015.cnblogs.com/blog/763020/201601/763020-20160127192653145-982192619.png">
<meta property="og:image" content="http://images2015.cnblogs.com/blog/763020/201601/763020-20160127192720848-622482433.png">
<meta property="og:image" content="http://s5.sinaimg.cn/orignal/6776884e07613adee2984&690">
<meta property="og:updated_time" content="2018-03-05T03:17:19.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="转载:MySQL索引之哈希索引和自适应哈希索引（Adaptive Hash Index）">
<meta name="twitter:description" content="索引（Index）是帮助MySQL高效获取数据的数据结构。提取句子主干，就可以得到索引的本质：索引是数据结构。                  从MySQL逻辑架构来看，MySQL有三层架构，第一层连接，第二层查询解析、分析、优化、视图、缓存，第三层，存储引擎。        索引通过分开查询片，节省了扫描查找时间，大大提升查询效率。  大部分数据库系统及文件系统都采用B-Tree或其变种B+T">
<meta name="twitter:image" content="http://xiaocao.u.qiniudn.com/blog/2015-09-13-mysql-hash-index-mysql-design.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://bloodorange2017.github.io/archives/2018/03/05/mysql-index/"/>





  <title>转载:MySQL索引之哈希索引和自适应哈希索引（Adaptive Hash Index） | XueCheng Notes</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  














  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">XueCheng Notes</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Where there is a will, there is a way.</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Startseite
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archiv
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://bloodorange2017.github.io/archives/2018/03/05/mysql-index/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="XueCheng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://bloodorange2017.github.io/images/img_head_001.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XueCheng Notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">转载:MySQL索引之哈希索引和自适应哈希索引（Adaptive Hash Index）</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-05T11:14:42+08:00">
                2018-03-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><span style="font-family:Courier New;color:#000000;font-size:16px;">索引（Index）是帮助MySQL高效获取数据的数据结构。提取句子主干，就可以得到索引的本质：索引是数据结构。</span><br>    </p><p><br>        <br><br>    </p><p></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""> <span style="font-family:Courier New;color:#000000;font-size:16px;">从MySQL逻辑架构来看，MySQL有三层架构，第一层连接，第二层查询解析、分析、优化、视图、缓存，第三层，存储引擎。</span><br></p><p></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""> <img src="http://xiaocao.u.qiniudn.com/blog/2015-09-13-mysql-hash-index-mysql-design.png" alt="MySQL逻辑架构" title="" style="font-family:courier new;color:#000000;font-size:16px;border-width:initial;border-style:none;box-sizing:border-box;max-width:100%;"><br>    </p><p></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""> <span style="font-family:Courier New;color:#000000;font-size:16px;">索引通过分开查询片，节省了扫描查找时间，大大提升查询效率。</span><br></p><p></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""> <span style="font-family:Courier New;color:#000000;font-size:16px;">大部分数据库系统及文件系统都采用B-Tree或其变种B+Tree作为索引结构。</span><br>    </p><p></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""> <span style="font-family:Courier New;color:#000000;font-size:16px;">索引主要在存储引擎层上，不同的引擎也就有不同的B-Tree算法。</span><br></p><p></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""><br><br>    </p><p></p>
<p><hr style="font-family:courier new;color:#000000;font-size:16px;box-sizing:border-box;margin:2em 0px;border-right:0px;border-bottom:0px;border-left:0px;border-image:initial;border-top-style:solid;border-top-color:rgba(128, 128, 128, 0.0980392);color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""><br><br></p><p></p>
<p></p><h1 id="0x01hash-index" style="font-family:courier new;color:#000000;font-size:16px;margin:0.8em 0px;padding:0px;box-sizing:border-box;font-weight:100;line-height:1.3em;font-size:2.6em;color:#3F3F3F;white-space:normal;background-color:#ffffff;" =""=""> <a name="t1"></a><span style="font-family:Courier New;color:#000000;font-size:16px;">0x01.Hash Index</span><br>    </h1><p></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""> <span style="font-family:Courier New;color:#000000;font-size:16px;">哈希索引只有Memory, NDB两种引擎支持，Memory引擎默认支持哈希索引，如果多个hash值相同，出现哈希碰撞，那么索引以链表方式存储。</span><br>        </p><p></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""> <span style="font-family:Courier New;color:#000000;font-size:16px;">但是，Memory引擎表只对能够适合机器的内存切实有限的数据集。</span><br>    </p><p></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""> <span style="font-family:Courier New;color:#000000;font-size:16px;">要使InnoDB或MyISAM支持哈希索引，可以通过伪哈希索引来实现，叫自适应哈希索引。</span><br>        </p><p></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""> <span style="font-family:Courier New;color:#000000;font-size:16px;">主要通过增加一个字段，存储hash值，将hash值建立索引，在插入和更新的时候，建立触发器，自动添加计算后的hash到表里。</span><br>    </p><p></p>
<p></p><h2 id="直接索引" style="font-family:courier new;color:#000000;font-size:16px;margin:0.8em 0px;padding:0px;box-sizing:border-box;font-weight:100;line-height:1.3em;font-size:2.13em;color:#3F3F3F;white-space:normal;background-color:#ffffff;" =""=""> <a name="t2"></a><span style="font-family:Courier New;color:#000000;font-size:16px;">直接索引</span><br>        </h2><p></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""> <span style="font-family:Courier New;color:#000000;font-size:16px;">假如有一个非常非常大的表，如下：</span><br><br><br><br><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">CREATE TABLE IF NOT EXISTS <code>User</code> (</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp; <code>id</code> int(10) NOT NULL COMMENT ‘自增id’,</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp; <code>name</code> varchar(128) NOT NULL DEFAULT ‘’ COMMENT ‘用户名’,</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp; <code>email</code> varchar(128) NOT NULL DEFAULT ‘’ COMMENT ‘用户邮箱’,</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp; <code>pass</code> varchar(64) NOT NULL DEFAULT ‘’ COMMENT ‘用户密码’,</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp; <code>last</code> timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT ‘最后登录时间’</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8;</span><br>            </p><p></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""> <span style="font-family:Courier New;color:#000000;font-size:16px;">这个时候，比如说，用户登陆，我需要通过email检索出用户，通过explain得到如下：</span><br>        </p><p></p>
<p><blockquote style="font-family:courier new;color:#000000;font-size:16px;box-sizing:border-box;margin:0px 0px 1.1em;padding:15px 20px;border-left:10px solid rgba(128, 128, 128, 0.0745098);background-color:rgba(128, 128, 128, 0.0470588);border-radius:0px 5px 5px 0px;color:#3F3F3F;font-size:15px;white-space:normal;" =""=""><br>        <p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:0px;box-sizing:border-box;line-height:1.25;"><br>            <span style="font-family:Courier New;color:#000000;font-size:16px;">mysql&gt; explain SELECT&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">id</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;FROM&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">User</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;WHERE email = ‘ooxx@gmail.com’ LIMIT 1;</span><br>        </p><br>            </blockquote></p>
<p><pre class="prettyprint" name="code" style="font-family:courier new;color:#000000;font-size:16px;white-space:nowrap;box-sizing:border-box;position:relative;overflow-y:hidden;overflow-x:auto;margin-top:0px;margin-bottom:1.1em;padding:5px=" "="" 5px="" 60px;font-size:14px;line-height:1.45;word-break:break-all;color:#333333;background-color:rgba(128,="" 128,="" 0.0470588);border:0px="" solid="" #888888;border-radius:0px;"="">+—-+————-+——-+——+—————+——+———+——+——–+————-+<br>| id | select_type | table | type | possible_keys | key &nbsp;| key_len | ref &nbsp;| rows &nbsp; | Extra &nbsp; &nbsp; &nbsp; |<br>+—-+————-+——-+——+—————+——+———+——+——–+————-+<br>| &nbsp;1 | SIMPLE &nbsp; &nbsp; &nbsp;| User &nbsp;| ALL &nbsp;| NULL &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| NULL | NULL &nbsp; &nbsp;| NULL | 384742 | Using where |<br>+—-+————-+——-+——+—————+——+———+——+——–+————-+</pre></p>
<p></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">发现&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">rows = 384742</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;也就是要在384742里面进行比对email这个字段的字符串。</span><br>                </p><p></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""> <span style="font-family:Courier New;color:#000000;font-size:16px;">这条记录运行的时间是：Query took 0.1744 seconds，数据库的大小是40万。</span><br>            </p><p></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""> <span style="font-family:Courier New;color:#000000;font-size:16px;">从上面可以说明，如果直接在email上面建立索引，除了索引区间匹配，还要进行字符串匹配比对，email短还好，如果长的话这个查询代价就比较大。</span><br>                </p><p></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""> <span style="font-family:Courier New;color:#000000;font-size:16px;">如果这个时候，在email上建立哈希索引，查询以int查询，性能就比字符串比对查询快多了。</span><br>            </p><p></p>
<p></p><h2 id="hash-算法" style="font-family:courier new;color:#000000;font-size:16px;margin:0.8em 0px;padding:0px;box-sizing:border-box;font-weight:100;line-height:1.3em;font-size:2.13em;color:#3F3F3F;white-space:normal;background-color:#ffffff;" =""=""> <a name="t3"></a><span style="font-family:Courier New;color:#000000;font-size:16px;">Hash 算法</span><br>                </h2><p></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""> <span style="font-family:Courier New;color:#000000;font-size:16px;">建立哈希索引，先选定哈希算法，这里选用CRC32。</span><br>                    </p><p></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""> <span style="font-family:Courier New;color:#000000;font-size:16px;">《高性能MySQL》说到的方法CRC32算法，建立SHA或MD5算法是划算的，本身位数都有可能比email段长了。</span><br>                </p><p></p>
<p></p><h2 id="insert-update-select-操作" style="font-family:courier new;color:#000000;font-size:16px;margin:0.8em 0px;padding:0px;box-sizing:border-box;font-weight:100;line-height:1.3em;font-size:2.13em;color:#3F3F3F;white-space:normal;background-color:#ffffff;" =""=""> <a name="t4"></a><span style="font-family:Courier New;color:#000000;font-size:16px;">INSERT UPDATE SELECT 操作</span><br>            </h2><p></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""> <span style="font-family:Courier New;color:#000000;font-size:16px;">在表中添加hash值的字段：</span><br>                </p><p></p>
<p><blockquote style="font-family:courier new;color:#000000;font-size:16px;box-sizing:border-box;margin:0px 0px 1.1em;padding:15px 20px;border-left:10px solid rgba(128, 128, 128, 0.0745098);background-color:rgba(128, 128, 128, 0.0470588);border-radius:0px 5px 5px 0px;color:#3F3F3F;font-size:15px;white-space:normal;" =""=""><br>                <p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:0px;box-sizing:border-box;line-height:1.25;"><br>                    <span style="font-family:Courier New;color:#000000;font-size:16px;">mysql&gt; ALTER TABLE&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">User</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;ADD COLUMN email_hash int unsigned NOT NULL DEFAULT 0;</span><br>                </p><br>                    </blockquote></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""> <span style="font-family:Courier New;color:#000000;font-size:16px;">接下来就是在UPDATE和INSERT的时候，自动更新&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">email_hash</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;字段，通过MySQL触发器实现：</span><br>                        </p><p></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""="">DELIMITER |<br><br>CREATE TRIGGER user_hash_insert BEFORE INSERT ON <code>User</code> FOR EACH ROW BEGIN<br><br>SET NEW.email_hash=crc32(NEW.email);<br><br>END;<br><br>|<br><br>CREATE TRIGGER user_hash_update BEFORE UPDATE ON <code>User</code> FOR EACH ROW BEGIN<br><br>SET NEW.email_hash=crc32(NEW.email);<br><br>END;<br><br>|<br><br>DELIMITER ;<br><br><br><br><br><br><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">这样的话，我们的SELECT请求就会变成这样：</span><br>                    </p><p></p>
<p><blockquote style="font-family:courier new;color:#000000;font-size:16px;box-sizing:border-box;margin:0px 0px 1.1em;padding:15px 20px;border-left:10px solid rgba(128, 128, 128, 0.0745098);background-color:rgba(128, 128, 128, 0.0470588);border-radius:0px 5px 5px 0px;color:#3F3F3F;font-size:15px;white-space:normal;" =""=""><br>                    <p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:0px;box-sizing:border-box;line-height:1.25;"><br>                        <span style="font-family:Courier New;color:#000000;font-size:16px;">mysql&gt; SELECT&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">email</span><span style="font-family:Courier New;color:#000000;font-size:16px;">,&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">email_hash</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;FROM&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">User</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;WHERE email_hash = CRC32(“F2dgTSWRBXSZ1d3O@gmail.com”) AND</span><span style="font-family:Courier New;color:#000000;font-size:16px;">email</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;= “F2dgTSWRBXSZ1d3O@gmail.com”;</span><br>                    </p><br>                </blockquote></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""><span style="font-family:Courier New;color:#000000;font-size:16px;"> <br><br>+—————————-+————+<br><br>| email &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| email_hash |<br><br>+—————————-+————+<br><br>| F2dgTSWRBXSZ1d3O@gmail.com | 2765311122 |<br><br>+—————————-+————+<br><br><br><br>在没建立hash索引时候，请求时间是 0.2374 seconds，建立完索引后，请求时间直接变成 0.0003 seconds。</span><br>            </p><p></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""> <span style="font-family:Courier New;color:#000000;font-size:16px;">AND email = “F2dgTSWRBXSZ1d3O@gmail.com”</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;是为了防止哈希碰撞导致数据不准确。</span><br>                </p><p></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""><br><br>            </p><p></p>
<p><hr style="font-family:courier new;color:#000000;font-size:16px;box-sizing:border-box;margin:2em 0px;border-right:0px;border-bottom:0px;border-left:0px;border-image:initial;border-top-style:solid;border-top-color:rgba(128, 128, 128, 0.0980392);color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""><br><br>                </p><p></p>
<p></p><h1 id="0x02hash-index-缺点" style="font-family:courier new;color:#000000;font-size:16px;margin:0.8em 0px;padding:0px;box-sizing:border-box;font-weight:100;line-height:1.3em;font-size:2.6em;color:#3F3F3F;white-space:normal;background-color:#ffffff;" =""=""> <a name="t5"></a><span style="font-family:Courier New;color:#000000;font-size:16px;">0x02.Hash Index 缺点</span><br>                    </h1><p></p>
<p></p><p style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:1.1em;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""> <span style="font-family:Courier New;color:#000000;font-size:16px;">哈希索引也有几个缺点：</span><br>                        </p><p></p>
<p><ul style="font-family:courier new;color:#000000;font-size:16px;box-sizing:border-box;color:#3F3F3F;font-size:15px;white-space:normal;background-color:#ffffff;" =""=""><br>                        <li style="font-family:courier new;color:#000000;font-size:16px;box-sizing:border-box;"><br>                            <span style="font-family:Courier New;color:#000000;font-size:16px;">索引存放的是hash值,所以仅支持 &lt; = &gt; 以及 IN 操作</span><br>                        </li><br>                        <li style="font-family:courier new;color:#000000;font-size:16px;box-sizing:border-box;"><br>                            <span style="font-family:Courier New;color:#000000;font-size:16px;">hash索引无法通过操作索引来排序，因为存放的时候经过hash计算，但是计算的hash值和存放的不一定相等，所以无法排序</span><br>                        </li><br>                        <li style="font-family:courier new;color:#000000;font-size:16px;box-sizing:border-box;"><br>                            <span style="font-family:Courier New;color:#000000;font-size:16px;">不能避免全表扫描，只是由于在memory表里支持非唯一值hash索引，就是不同的索引键，可能存在相同的hash值</span><br>                        </li><br>                        <li style="font-family:courier new;color:#000000;font-size:16px;box-sizing:border-box;"><br>                            <span style="font-family:Courier New;color:#000000;font-size:16px;">如果哈希碰撞很多的话，性能也会变得很差</span><br>                        </li><br>                        <li style="font-family:courier new;color:#000000;font-size:16px;box-sizing:border-box;"><br>                            <span style="font-family:Courier New;color:#000000;font-size:16px;">哈希索引无法被用来避免数据的排序操作</span><br>                        </li><br>                            </ul><br><br><br>                            <hr><br>                            <hr><br>                            <br><br><strong><span style="font-family:courier new;color:#000000;font-size:24px;"></span></strong><a href="http://blog.csdn.net/defonds/article/details/46787105" style="font-family:courier new;color:#000000;font-size:16px;color:#333333;text-decoration:none;font-size:20px;white-space:normal;background-color:#ffffff;" =""="" target="_blank" rel="external"><strong><span style="font-family:courier new;color:#000000;font-size:24px;">警惕 InnoDB 和 MyISAM 创建 Hash 索引陷阱</span></strong></a><br><br><br><br><span style="font-family:courier new;color:#000000;font-size:16px;font-size:14px;white-space:normal;background-color:#ffffff;" =""="">MySql 最常用存储引擎 InnoDB 和 MyISAM 都不支持 Hash 索引，它们默认的索引都是 B-Tree。但是如果你在创建索引的时候定义其类型为 Hash，MySql 并不会报错，而且你通过 SHOW CREATE TABLE 查看该索引也是 Hash，只不过该索引实际上还是 B-Tree。</span><br style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;"><br><span style="font-family:courier new;color:#000000;font-size:16px;font-size:14px;white-space:normal;background-color:#ffffff;" =""="">比如表 data_dict 的 DDL：</span><br style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;"></p>
<div class="dp-highlighter bg_sql" style="font-family:courier new;color:#000000;font-size:16px;font-family:Consolas, " background-color:#e7e5dc;width:936.531px;overflow-x:auto;overflow-y:hidden;padding-top:1px;position:relative;white-space:normal;margin:18px="" 0px="" !important;"="">
                            <div class="bar" style="font-family:courier new;color:#000000;font-size:16px;padding-left:45px;">
                                <div class="tools" style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;font-size:9px;padding:3px 8px 10px 10px;font-stretch:normal;line-height:normal;background-color:#F8F8F8;border-left:3px solid #999999;">
                                    <b><span style="font-family:Courier New;color:#000000;font-size:16px;">[sql]</span></b><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="ViewSource" title="view plain" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">view plain</span></a><span data-mod="popu_168"><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="CopyToClipboard" title="copy" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">copy</span></a> 
                                    <div style="font-family:courier new;color:#000000;font-size:16px;position:absolute;left:702px;top:447px;width:29px;height:14px;z-index:99;">
                                    </div>
</span><span data-mod="popu_169"><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="PrintSource" title="print" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">print</span></a></span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="About" title="?" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">?</span></a> 
                                </div>
                            </div>
                            <ol start="1" class="dp-sql" style="font-family:courier new;color:#5C5C5C;font-size:16px;padding:0px;border:none;list-style-position:initial;list-style-image:initial;background-color:#FFFFFF;margin:0px 0px 1px 45px !important;">
                                <li class="alt" style="font-family:courier new;color:inherit;font-size:16px;margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #999999;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;background-color:#F5FAE2;line-height:18px;list-style-position:outside !important;">
                                    <span style="font-family:courier new;color:black;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;"><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">CREATE</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;</span><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">TABLE</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;`data_dict`&nbsp;(&nbsp;&nbsp;</span></span> 
                                </li>
                                <li class="" style="font-family:courier new;color:#555555;font-size:16px;margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #999999;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;background-color:#F5FAE2;line-height:18px;list-style-position:outside !important;">
                                    <span style="font-family:courier new;color:black;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;"><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;&nbsp;`data_type`&nbsp;</span><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">varchar</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">(32)&nbsp;</span><span class="op" style="font-family:courier new;color:#808080;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">NOT</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;</span><span class="op" style="font-family:courier new;color:#808080;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">NULL</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;COMMENT&nbsp;</span><span class="string" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">'数据字典类型'</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;&nbsp;</span></span> 
                                </li>
                                <li class="alt" style="font-family:courier new;color:inherit;font-size:16px;margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #999999;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;background-color:#F5FAE2;line-height:18px;list-style-position:outside !important;">
                                    <span style="font-family:courier new;color:black;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;"><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;&nbsp;`data_code`&nbsp;tinyint(4)&nbsp;</span><span class="op" style="font-family:courier new;color:#808080;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">NOT</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;</span><span class="op" style="font-family:courier new;color:#808080;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">NULL</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;COMMENT&nbsp;</span><span class="string" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">'数据字典代码'</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;&nbsp;</span></span> 
                                </li>
                                <li class="" style="font-family:courier new;color:#555555;font-size:16px;margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #999999;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;background-color:#F5FAE2;line-height:18px;list-style-position:outside !important;">
                                    <span style="font-family:courier new;color:black;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;"><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;&nbsp;`data_name`&nbsp;</span><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">varchar</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">(64)&nbsp;</span><span class="op" style="font-family:courier new;color:#808080;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">NOT</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;</span><span class="op" style="font-family:courier new;color:#808080;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">NULL</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;COMMENT&nbsp;</span><span class="string" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">'数据字典值'</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;&nbsp;</span></span> 
                                </li>
                                <li class="alt" style="font-family:courier new;color:inherit;font-size:16px;margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #999999;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;background-color:#F5FAE2;line-height:18px;list-style-position:outside !important;">
                                    <span style="font-family:courier new;color:black;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;"><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;&nbsp;</span><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">PRIMARY</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;</span><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">KEY</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;(`data_type`,`data_code`)&nbsp;&nbsp;</span></span> 
                                </li>
                                <li class="" style="font-family:courier new;color:#555555;font-size:16px;margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #999999;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;background-color:#F5FAE2;line-height:18px;list-style-position:outside !important;">
                                    <span style="font-family:courier new;color:black;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;"><span style="font-family:Courier New;color:#000000;font-size:16px;">)&nbsp;ENGINE=InnoDB&nbsp;</span><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">DEFAULT</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;CHARSET=utf8&nbsp;COMMENT=</span><span class="string" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">'数据字典表'</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;&nbsp;</span></span> 
                                </li>
                            </ol>
                                </div>
<br style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;">
<span style="font-family:courier new;color:#000000;font-size:16px;font-size:14px;white-space:normal;background-color:#ffffff;" =""="">我们为 data_name 字段建立 Hash 索引：</span><br style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;">
<div class="dp-highlighter bg_sql" style="font-family:courier new;color:#000000;font-size:16px;font-family:Consolas, " background-color:#e7e5dc;width:936.531px;overflow-x:auto;overflow-y:hidden;padding-top:1px;position:relative;white-space:normal;margin:18px="" 0px="" !important;"=""><br>                                <div class="bar" style="font-family:courier new;color:#000000;font-size:16px;padding-left:45px;"><br>                                    <div class="tools" style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;font-size:9px;padding:3px 8px 10px 10px;font-stretch:normal;line-height:normal;background-color:#F8F8F8;border-left:3px solid #999999;"><br>                                        <b><span style="font-family:Courier New;color:#000000;font-size:16px;">[sql]</span></b><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="ViewSource" title="view plain" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">view plain</span></a><span data-mod="popu_168"><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="CopyToClipboard" title="copy" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">copy</span></a><br>                                        <div style="font-family:courier new;color:#000000;font-size:16px;position:absolute;left:702px;top:672px;width:29px;height:14px;z-index:99;"><br>                                        </div><br></span><span data-mod="popu_169"><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="PrintSource" title="print" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">print</span></a></span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="About" title="?" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">?</span></a><br>                                    </div><br>                                </div><br>                                <ol start="1" class="dp-sql" style="font-family:courier new;color:#5C5C5C;font-size:16px;padding:0px;border:none;list-style-position:initial;list-style-image:initial;background-color:#FFFFFF;margin:0px 0px 1px 45px !important;"><br>                                    <li class="alt" style="font-family:courier new;color:inherit;font-size:16px;margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #999999;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;background-color:#F5FAE2;line-height:18px;list-style-position:outside !important;"><br>                                        <span style="font-family:courier new;color:black;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;"><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">ALTER</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;</span><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">TABLE</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;data_dict&nbsp;</span><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">ADD</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;</span><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">INDEX</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;data_dict_dn&nbsp;USING&nbsp;HASH&nbsp;(data_name);&nbsp;&nbsp;</span></span><br>                                    </li><br>                                </ol><br>                            </div><br><br style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;"><br><span style="font-family:courier new;color:#000000;font-size:16px;font-size:14px;white-space:normal;background-color:#ffffff;" =""="">打印结果：</span><br style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;"><br><span style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFCCCC;"><span style="font-family:Courier New;color:#000000;font-size:16px;">受影响的行: 0</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">时间: 0.345s</span></span><br style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;"><br><span style="font-family:courier new;color:#000000;font-size:16px;font-size:14px;white-space:normal;background-color:#ffffff;" =""="">然后查看建表 DDL：</span><br style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;"><br><div class="dp-highlighter bg_sql" style="font-family:courier new;color:#000000;font-size:16px;font-family:Consolas, " background-color:#e7e5dc;width:936.531px;overflow-x:auto;overflow-y:hidden;padding-top:1px;position:relative;white-space:normal;margin:18px="" 0px="" !important;"="">
                            <div class="bar" style="font-family:courier new;color:#000000;font-size:16px;padding-left:45px;">
                                <div class="tools" style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;font-size:9px;padding:3px 8px 10px 10px;font-stretch:normal;line-height:normal;background-color:#F8F8F8;border-left:3px solid #999999;">
                                    <b><span style="font-family:Courier New;color:#000000;font-size:16px;">[sql]</span></b><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="ViewSource" title="view plain" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">view plain</span></a><span data-mod="popu_168"><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="CopyToClipboard" title="copy" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">copy</span></a> 
                                    <div style="font-family:courier new;color:#000000;font-size:16px;position:absolute;left:702px;top:885px;width:29px;height:14px;z-index:99;">
                                    </div>
</span><span data-mod="popu_169"><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="PrintSource" title="print" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">print</span></a></span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="About" title="?" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">?</span></a> 
                                </div>
                            </div>
                            <ol start="1" class="dp-sql" style="font-family:courier new;color:#5C5C5C;font-size:16px;padding:0px;border:none;list-style-position:initial;list-style-image:initial;background-color:#FFFFFF;margin:0px 0px 1px 45px !important;">
                                <li class="alt" style="font-family:courier new;color:inherit;font-size:16px;margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #999999;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;background-color:#F5FAE2;line-height:18px;list-style-position:outside !important;">
                                    <span style="font-family:courier new;color:black;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;"><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">SHOW&nbsp;</span><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">CREATE</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;</span><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">TABLE</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;data_dict;&nbsp;&nbsp;</span></span> 
                                </li>
                            </ol>
                                </div>
<br style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;">
<span style="font-family:courier new;color:#000000;font-size:16px;font-size:14px;white-space:normal;background-color:#ffffff;" =""="">打印结果：</span><br style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;">
<span style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFCCCC;"><span style="font-family:Courier New;color:#000000;font-size:16px;">CREATE TABLE `data_dict` (</span><br>
<span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp; `data_type` varchar(32) NOT NULL COMMENT '数据字典类型',</span><br>
<span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp; `data_code` tinyint(4) NOT NULL COMMENT '数据字典代码',</span><br>
<span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp; `data_name` varchar(64) NOT NULL COMMENT '数据字典值',</span><br>
<span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp; PRIMARY KEY (`data_type`,`data_code`),</span><br>
<span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp; KEY `data_dict_dn` (`data_name`) USING&nbsp;</span><span style="font-family:courier new;color:#FF0000;font-size:16px;"><strong>HASH</strong></span><br>
<span style="font-family:Courier New;color:#000000;font-size:16px;">) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='数据字典表'</span></span><br style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;">
<span style="font-family:courier new;color:#000000;font-size:16px;font-size:14px;white-space:normal;background-color:#ffffff;" =""="">是 Hash，所以我们以为创建 Hash 索引成功。</span><br style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;">
<span style="font-family:courier new;color:#000000;font-size:16px;font-size:14px;white-space:normal;background-color:#ffffff;" =""="">事实上并非如此，我们都被 MySql 给骗了，我们使用 SHOW INDEXES FROM 语句对该表索引进行检索：</span><br style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;">
<div class="dp-highlighter bg_sql" style="font-family:courier new;color:#000000;font-size:16px;font-family:Consolas, " background-color:#e7e5dc;width:936.531px;overflow-x:auto;overflow-y:hidden;padding-top:1px;position:relative;white-space:normal;margin:18px="" 0px="" !important;"=""><br>                                <div class="bar" style="font-family:courier new;color:#000000;font-size:16px;padding-left:45px;"><br>                                    <div class="tools" style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;font-size:9px;padding:3px 8px 10px 10px;font-stretch:normal;line-height:normal;background-color:#F8F8F8;border-left:3px solid #999999;"><br>                                        <b><span style="font-family:Courier New;color:#000000;font-size:16px;">[sql]</span></b><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="ViewSource" title="view plain" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">view plain</span></a><span data-mod="popu_168"><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="CopyToClipboard" title="copy" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">copy</span></a><br>                                        <div style="font-family:courier new;color:#000000;font-size:16px;position:absolute;left:702px;top:1254px;width:29px;height:14px;z-index:99;"><br>                                        </div><br></span><span data-mod="popu_169"><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="PrintSource" title="print" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">print</span></a></span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="About" title="?" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">?</span></a><br>                                    </div><br>                                </div><br>                                <ol start="1" class="dp-sql" style="font-family:courier new;color:#5C5C5C;font-size:16px;padding:0px;border:none;list-style-position:initial;list-style-image:initial;background-color:#FFFFFF;margin:0px 0px 1px 45px !important;"><br>                                    <li class="alt" style="font-family:courier new;color:inherit;font-size:16px;margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #999999;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;background-color:#F5FAE2;line-height:18px;list-style-position:outside !important;"><br>                                        <span style="font-family:courier new;color:black;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;"><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">SHOW&nbsp;INDEXES&nbsp;</span><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">FROM</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;data_dict;&nbsp;&nbsp;</span></span><br>                                    </li><br>                                </ol><br>                            </div><br><br style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;"><br><span style="font-family:courier new;color:#000000;font-size:16px;font-size:14px;white-space:normal;background-color:#ffffff;" =""="">打印结果：</span><br style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;"><br><img src="http://img.blog.csdn.net/20150707113055755?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="我们使用 SHOW INDEXES FROM 语句对该表索引进行检索" style="font-family:courier new;color:#000000;font-size:14px;border-width:initial;border-style:none;max-width:100%;white-space:normal;background-color:#FFFFFF;"><br style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;"><br><span style="font-family:courier new;color:#000000;font-size:16px;font-size:14px;white-space:normal;background-color:#ffffff;" =""="">打回原形了。不过也不要失望，虽然常见存储引擎并不支持 Hash 索引，但 InnoDB 有另一种实现方法：自适应哈希索引。InnoDB 存储引擎会监控对表上索引的查找，如果观察到建立哈希索引可以带来速度的提升，则建立哈希索引。</span><br style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;"><br><span style="font-family:courier new;color:#000000;font-size:16px;font-size:14px;white-space:normal;background-color:#ffffff;" =""="">我们可以通过 SHOW ENGINE INNODB STATUS 来查看当前自适应哈希索引的使用状况：</span><br style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;"><br><span style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFCCCC;"><span style="font-family:Courier New;color:#000000;font-size:16px;">=====================================</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">2015-07-07 10:51:19 1d68 INNODB MONITOR OUTPUT</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">=====================================</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">Per second averages calculated from the last 36 seconds</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">……</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">————————————-</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">INSERT BUFFER AND ADAPTIVE HASH INDEX</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">————————————-</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">Ibuf: size 1, free list len 2633, seg size 2635, 0 merges</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">merged operations:</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;insert 0, delete mark 0, delete 0</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">discarded operations:</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;insert 0, delete mark 0, delete 0</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">Hash table size 348731, node heap has 2 buffer(s)</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">0.00 hash searches/s, 0.00 non-hash searches/s</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">……</span></span><br style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;"><br><span style="font-family:courier new;color:#000000;font-size:16px;font-size:14px;white-space:normal;background-color:#ffffff;" =""="">从中我们可以看到自适应哈希索引的相关信息：有使用大小、使用情况、每秒使用自适应哈希索引搜索的情况等。</span><br style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;"><br><span style="font-family:courier new;color:#000000;font-size:16px;font-size:14px;white-space:normal;background-color:#ffffff;" =""="">MySql 各种存储引擎的特性对比详单：</span><br style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;"><br><img src="http://img.blog.csdn.net/20150707113158731?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="MySql 各种存储引擎的特性对比详单" style="font-family:courier new;color:#000000;font-size:14px;border-width:initial;border-style:none;max-width:100%;white-space:normal;background-color:#FFFFFF;"><br style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;"><br><span style="font-family:courier new;color:#000000;font-size:16px;font-size:14px;white-space:normal;background-color:#ffffff;" =""="">从中我们可以看出，</span><br style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;"><br>                            <ul style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;"><br>                                <li><br>                                    <span style="font-family:Courier New;color:#000000;font-size:16px;">InnoDB 支持事务，支持行级别锁定，支持 B-tree、Full-text 等索引，不支持 Hash 索引；</span><br>                                </li><br>                                <li><br>                                    <span style="font-family:Courier New;color:#000000;font-size:16px;">MyISAM 不支持事务，支持表级别锁定，支持 B-tree、Full-text 等索引，不支持 Hash 索引；</span><br>                                </li><br>                                <li><br>                                    <span style="font-family:Courier New;color:#000000;font-size:16px;">Memory 不支持事务，支持表级别锁定，支持 B-tree、Hash 等索引，不支持 Full-text 索引；</span><br>                                </li><br>                                <li><br>                                    <span style="font-family:Courier New;color:#000000;font-size:16px;">NDB 支持事务，支持行级别锁定，支持 Hash 索引，不支持 B-tree、Full-text 等索引；</span><br>                                </li><br>                                <li><br>                                    <span style="font-family:Courier New;color:#000000;font-size:16px;">Archive 不支持事务，支持表级别锁定，不支持 B-tree、Hash、Full-text 等索引；</span><br>                                </li><br>                            </ul><br><span style="font-family:courier new;color:#000000;font-size:16px;font-size:14px;white-space:normal;background-color:#ffffff;" =""="">可以使用 SHOW ENGINES 语句查看你的 MySql Server 所支持的存储引擎，比如笔者用于本机测试的 5.6.25-log Win 版的查看结果如下：</span><br style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;"><br><img src="http://img.blog.csdn.net/20150707113246099?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="支持的存储引擎" style="font-family:courier new;color:#000000;font-size:14px;border-width:initial;border-style:none;max-width:100%;white-space:normal;background-color:#FFFFFF;"><br style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;"><br>                            <p style="font-family:courier new;color:#000000;font-size:14px;margin-top:0px;margin-bottom:0px;white-space:normal;background-color:#FFFFFF;"><br>                                <span style="font-family:Courier New;color:#000000;font-size:16px;">从中可以看出，InnoDB 是该版本 MySql 的默认存储引擎，也只有 InnoDB 能够支持事务、行级别锁定、外键；支持的 MEMORY 是基于哈希的，数据都存放于内存，适用于临时表。没有看到既支持事务又支持哈希索引的 NDB 的身影。</span><br>                            </p><br>                            <p style="font-family:courier new;color:#000000;font-size:14px;margin-top:0px;margin-bottom:0px;white-space:normal;background-color:#FFFFFF;"><br>                                <span style="font-family:Courier New;color:#000000;font-size:16px;">为印证默认的存储引擎，我们创建一个测试表&nbsp;data_dict_test，注意建表语句里没有定义存储引擎：</span><br>                            </p><br>                            <p style="font-family:courier new;color:#000000;font-size:14px;margin-top:0px;margin-bottom:0px;white-space:normal;background-color:#FFFFFF;"><br>                                <br><br>                            </p><br><div class="dp-highlighter bg_sql" style="font-family:courier new;color:#000000;font-size:16px;font-family:Consolas, " background-color:#e7e5dc;width:936.531px;overflow-x:auto;overflow-y:hidden;padding-top:1px;position:relative;white-space:normal;margin:18px="" 0px="" !important;"="">
                            <div class="bar" style="font-family:courier new;color:#000000;font-size:16px;padding-left:45px;">
                                <div class="tools" style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;font-size:9px;padding:3px 8px 10px 10px;font-stretch:normal;line-height:normal;background-color:#F8F8F8;border-left:3px solid #999999;">
                                    <b><span style="font-family:Courier New;color:#000000;font-size:16px;">[sql]</span></b><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="ViewSource" title="view plain" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">view plain</span></a><span data-mod="popu_168"><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="CopyToClipboard" title="copy" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">copy</span></a> 
                                    <div style="font-family:courier new;color:#000000;font-size:16px;position:absolute;left:702px;top:3114px;width:29px;height:14px;z-index:99;">
                                    </div>
</span><span data-mod="popu_169"><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="PrintSource" title="print" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">print</span></a></span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="About" title="?" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">?</span></a> 
                                </div>
                            </div>
                            <ol start="1" class="dp-sql" style="font-family:courier new;color:#5C5C5C;font-size:16px;padding:0px;border:none;list-style-position:initial;list-style-image:initial;background-color:#FFFFFF;margin:0px 0px 1px 45px !important;">
                                <li class="alt" style="font-family:courier new;color:inherit;font-size:16px;margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #999999;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;background-color:#F5FAE2;line-height:18px;list-style-position:outside !important;">
                                    <span style="font-family:courier new;color:black;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;"><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">CREATE</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;</span><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">TABLE</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;`data_dict_test`&nbsp;(&nbsp;&nbsp;</span></span> 
                                </li>
                                <li class="" style="font-family:courier new;color:#555555;font-size:16px;margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #999999;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;background-color:#F5FAE2;line-height:18px;list-style-position:outside !important;">
                                    <span style="font-family:courier new;color:black;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;"><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;&nbsp;`data_type`&nbsp;</span><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">varchar</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">(32)&nbsp;</span><span class="op" style="font-family:courier new;color:#808080;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">NOT</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;</span><span class="op" style="font-family:courier new;color:#808080;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">NULL</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;COMMENT&nbsp;</span><span class="string" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">'数据字典类型'</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;&nbsp;</span></span> 
                                </li>
                                <li class="alt" style="font-family:courier new;color:inherit;font-size:16px;margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #999999;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;background-color:#F5FAE2;line-height:18px;list-style-position:outside !important;">
                                    <span style="font-family:courier new;color:black;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;"><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;&nbsp;`data_code`&nbsp;tinyint(4)&nbsp;</span><span class="op" style="font-family:courier new;color:#808080;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">NOT</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;</span><span class="op" style="font-family:courier new;color:#808080;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">NULL</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;COMMENT&nbsp;</span><span class="string" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">'数据字典代码'</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;&nbsp;</span></span> 
                                </li>
                                <li class="" style="font-family:courier new;color:#555555;font-size:16px;margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #999999;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;background-color:#F5FAE2;line-height:18px;list-style-position:outside !important;">
                                    <span style="font-family:courier new;color:black;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;"><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;&nbsp;`data_name`&nbsp;</span><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">varchar</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">(64)&nbsp;</span><span class="op" style="font-family:courier new;color:#808080;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">NOT</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;</span><span class="op" style="font-family:courier new;color:#808080;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">NULL</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;COMMENT&nbsp;</span><span class="string" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">'数据字典值'</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">,&nbsp;&nbsp;</span></span> 
                                </li>
                                <li class="alt" style="font-family:courier new;color:inherit;font-size:16px;margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #999999;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;background-color:#F5FAE2;line-height:18px;list-style-position:outside !important;">
                                    <span style="font-family:courier new;color:black;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;"><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;&nbsp;</span><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">PRIMARY</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;</span><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">KEY</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;(`data_type`,`data_code`)&nbsp;&nbsp;</span></span> 
                                </li>
                                <li class="" style="font-family:courier new;color:#555555;font-size:16px;margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #999999;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;background-color:#F5FAE2;line-height:18px;list-style-position:outside !important;">
                                    <span style="font-family:courier new;color:black;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;"><span style="font-family:Courier New;color:#000000;font-size:16px;">)&nbsp;</span><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">DEFAULT</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;CHARSET=utf8&nbsp;COMMENT=</span><span class="string" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">'数据字典表'</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;&nbsp;</span></span> 
                                </li>
                            </ol>
                                </div>
<span style="font-family:courier new;color:#000000;font-size:16px;font-size:14px;white-space:normal;background-color:#ffffff;" =""="">打印结果：</span> 
                                <p style="font-family:courier new;color:#000000;font-size:14px;margin-top:0px;margin-bottom:0px;white-space:normal;background-color:#FFFFFF;">
                                    <br>
                                </p>
                                <p style="font-family:courier new;color:#000000;font-size:14px;margin-top:0px;margin-bottom:0px;white-space:normal;background-color:#FFFFFF;">
                                    <span style="font-family:courier new;color:#000000;font-size:16px;background-color:#FFCCCC;"><span style="font-family:Courier New;color:#000000;font-size:16px;">[SQL] CREATE TABLE `data_dict_test` (</span><br>
<span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp; `data_type` varchar(32) NOT NULL COMMENT '数据字典类型',</span><br>
<span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp; `data_code` tinyint(4) NOT NULL COMMENT '数据字典代码',</span><br>
<span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp; `data_name` varchar(64) NOT NULL COMMENT '数据字典值',</span><br>
<span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp; PRIMARY KEY (`data_type`,`data_code`)</span><br>
<span style="font-family:Courier New;color:#000000;font-size:16px;">) DEFAULT CHARSET=utf8 COMMENT='数据字典表';</span><br>
<span style="font-family:Courier New;color:#000000;font-size:16px;">受影响的行: 0</span><br>
<span style="font-family:Courier New;color:#000000;font-size:16px;">时间: 0.262s</span></span> 
                                </p>
                                <p style="font-family:courier new;color:#000000;font-size:14px;margin-top:0px;margin-bottom:0px;white-space:normal;background-color:#FFFFFF;">
                                    <span style="font-family:Courier New;color:#000000;font-size:16px;">然后查看建表 DDL：</span> 
                                </p>
                                <p style="font-family:courier new;color:#000000;font-size:14px;margin-top:0px;margin-bottom:0px;white-space:normal;background-color:#FFFFFF;">
                                    <br>
                                </p>
<div class="dp-highlighter bg_sql" style="font-family:courier new;color:#000000;font-size:16px;font-family:Consolas, " background-color:#e7e5dc;width:936.531px;overflow-x:auto;overflow-y:hidden;padding-top:1px;position:relative;white-space:normal;margin:18px="" 0px="" !important;"=""><br>                                <div class="bar" style="font-family:courier new;color:#000000;font-size:16px;padding-left:45px;"><br>                                    <div class="tools" style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;font-size:9px;padding:3px 8px 10px 10px;font-stretch:normal;line-height:normal;background-color:#F8F8F8;border-left:3px solid #999999;"><br>                                        <b><span style="font-family:Courier New;color:#000000;font-size:16px;">[sql]</span></b><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="ViewSource" title="view plain" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">view plain</span></a><span data-mod="popu_168"><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="CopyToClipboard" title="copy" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">copy</span></a><br>                                        <div style="font-family:courier new;color:#000000;font-size:16px;position:absolute;left:702px;top:3547px;width:29px;height:14px;z-index:99;"><br>                                        </div><br></span><span data-mod="popu_169"><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="PrintSource" title="print" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">print</span></a></span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="About" title="?" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">?</span></a><br>                                    </div><br>                                </div><br>                                <ol start="1" class="dp-sql" style="font-family:courier new;color:#5C5C5C;font-size:16px;padding:0px;border:none;list-style-position:initial;list-style-image:initial;background-color:#FFFFFF;margin:0px 0px 1px 45px !important;"><br>                                    <li class="alt" style="font-family:courier new;color:inherit;font-size:16px;margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #999999;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;background-color:#F5FAE2;line-height:18px;list-style-position:outside !important;"><br>                                        <span style="font-family:courier new;color:black;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;"><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">SHOW&nbsp;</span><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">CREATE</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;</span><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">TABLE</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;data_dict_test;&nbsp;&nbsp;</span></span><br>                                    </li><br>                                </ol><br>                            </div><br><span style="font-family:courier new;color:#000000;font-size:16px;font-size:14px;white-space:normal;background-color:#ffffff;" =""="">打印结果：</span><br>                            <p style="font-family:courier new;color:#000000;font-size:14px;margin-top:0px;margin-bottom:0px;white-space:normal;background-color:#FFFFFF;"><br>                                <br><br>                            </p><br>                            <p style="font-family:courier new;color:#000000;font-size:14px;margin-top:0px;margin-bottom:0px;white-space:normal;background-color:#FFFFFF;"><br>                                <span style="font-family:courier new;color:#000000;font-size:16px;background-color:#FFCCCC;"><span style="font-family:Courier New;color:#000000;font-size:16px;">CREATE TABLE <code>data_dict_test</code> (</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp; <code>data_type</code> varchar(32) NOT NULL COMMENT ‘数据字典类型’,</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp; <code>data_code</code> tinyint(4) NOT NULL COMMENT ‘数据字典代码’,</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp; <code>data_name</code> varchar(64) NOT NULL COMMENT ‘数据字典值’,</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp; PRIMARY KEY (<code>data_type</code>,<code>data_code</code>)</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT=’数据字典表’</span></span><br>                            </p><br>                            <p style="font-family:courier new;color:#000000;font-size:14px;margin-top:0px;margin-bottom:0px;white-space:normal;background-color:#FFFFFF;"><br>                                <span style="font-family:Courier New;color:#000000;font-size:16px;">这次 SHOW CREATE TABLE 没有欺骗我们，明确给出的就是 InnoDB，虽然我们建表时没有指定。</span><br>                            </p><br>                            <p style="font-family:courier new;color:#000000;font-size:14px;margin-top:0px;margin-bottom:0px;white-space:normal;background-color:#FFFFFF;"><br>                                <span style="font-family:Courier New;color:#000000;font-size:16px;">笔者建议使用 SHOW TABLE STATUS 语句来查看特定表的存储引擎：</span><br>                            </p><br>                            <p style="font-family:courier new;color:#000000;font-size:14px;margin-top:0px;margin-bottom:0px;white-space:normal;background-color:#FFFFFF;"><br>                                <br><br>                            </p><br><div class="dp-highlighter bg_sql" style="font-family:courier new;color:#000000;font-size:16px;font-family:Consolas, " background-color:#e7e5dc;width:936.531px;overflow-x:auto;overflow-y:hidden;padding-top:1px;position:relative;white-space:normal;margin:18px="" 0px="" !important;"="">
                            <div class="bar" style="font-family:courier new;color:#000000;font-size:16px;padding-left:45px;">
                                <div class="tools" style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:silver;font-size:9px;padding:3px 8px 10px 10px;font-stretch:normal;line-height:normal;background-color:#F8F8F8;border-left:3px solid #999999;">
                                    <b><span style="font-family:Courier New;color:#000000;font-size:16px;">[sql]</span></b><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="ViewSource" title="view plain" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">view plain</span></a><span data-mod="popu_168"><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="CopyToClipboard" title="copy" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">copy</span></a> 
                                    <div style="font-family:courier new;color:#000000;font-size:16px;position:absolute;left:702px;top:3864px;width:29px;height:14px;z-index:99;">
                                    </div>
</span><span data-mod="popu_169"><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="PrintSource" title="print" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">print</span></a></span><a href="http://blog.csdn.net/defonds/article/details/46787105#" class="About" title="?" target="_blank" style="font-family:courier new;color:#A0A0A0;font-size:9px;text-decoration:none;background-image:none;background-position:initial;background-size:initial;background-repeat:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:inherit;border:none;padding:0px;margin:0px 10px 0px 0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">?</span></a> 
                                </div>
                            </div>
                            <ol start="1" class="dp-sql" style="font-family:courier new;color:#5C5C5C;font-size:16px;padding:0px;border:none;list-style-position:initial;list-style-image:initial;background-color:#FFFFFF;margin:0px 0px 1px 45px !important;">
                                <li class="alt" style="font-family:courier new;color:inherit;font-size:16px;margin:0px !important;padding:0px 3px 0px 10px !important;border-top:none;border-right:none;border-bottom:none;border-left:3px solid #999999;border-image:initial;list-style-type:decimal-leading-zero;list-style-image:initial;background-color:#F5FAE2;line-height:18px;list-style-position:outside !important;">
                                    <span style="font-family:courier new;color:black;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;"><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">SHOW&nbsp;</span><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">TABLE</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;STATUS&nbsp;</span><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">WHERE</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;</span><span class="keyword" style="font-family:courier new;color:blue;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;font-weight:bold;">NAME</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">&nbsp;=&nbsp;</span><span class="string" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">'data_dict_test'</span><span style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;border:none;background-color:inherit;">;&nbsp;&nbsp;</span></span> 
                                </li>
                            </ol>
                                </div>
<span style="font-family:courier new;color:#000000;font-size:16px;font-size:14px;white-space:normal;background-color:#ffffff;" =""="">打印结果：</span> 
                                <p style="font-family:courier new;color:#000000;font-size:14px;margin-top:0px;margin-bottom:0px;white-space:normal;background-color:#FFFFFF;">
                                    <br>
                                </p>
                                <p style="font-family:courier new;color:#000000;font-size:14px;margin-top:0px;margin-bottom:0px;white-space:normal;background-color:#FFFFFF;">
                                    <img src="http://img.blog.csdn.net/20150708144647587?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="SHOW TABLE STATUS WHERE NAME = 'data_dict_test'" style="font-family:courier new;color:#000000;font-size:16px;border-width:initial;border-style:none;max-width:100%;"> 
                                </p>
                                <p style="font-family:courier new;color:#000000;font-size:14px;margin-top:0px;margin-bottom:0px;white-space:normal;background-color:#FFFFFF;">
                                    <br>
                                </p>
                                <h1 style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;white-space:normal;background-color:#FFFFFF;">
                                    <span style="font-family:Courier New;color:#000000;font-size:16px;">参考资料</span> 
                                </h1>
                                <ul style="font-family:courier new;color:#000000;font-size:14px;white-space:normal;background-color:#FFFFFF;">
                                    <li>
                                        <a target="_blank" href="http://dev.mysql.com/doc/refman/5.6/en/storage-engines.html" style="font-family:courier new;color:#FF9900;font-size:16px;text-decoration:none;"><span style="font-family:Courier New;color:#000000;font-size:16px;">http://dev.mysql.com/doc/refman/5.6/en/storage-engines.html</span></a> 
                                    </li>
                                    <li>
                                        <a target="_blank" href="http://dba.stackexchange.com/questions/2817/why-does-mysql-not-have-hash-indices-on-myisam-or-innodb" style="font-family:courier new;color:#FF9900;font-size:16px;text-decoration:none;"><span style="font-family:Courier New;color:#000000;font-size:16px;">http://dba.stackexchange.com/questions/2817/why-does-mysql-not-have-hash-indices-on-myisam-or-innodb</span></a> 
                                    </li>
                                </ul>
                                <hr>
                                <hr>
                                <div id="cnblogs_post_body" style="font-family:courier new;color:#000000;font-size:16px;margin:0px 0px 20px;padding:0px;word-break:break-word;color:#393939;font-family:verdana, " font-size:14px;white-space:normal;background-color:#faf7ef;"=""><br>                                <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">btree索引：</span><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">如果没有特别指明类型，多半说的就是</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">btree索引，它使用</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">btree数据结构来存储数据，大</span><strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">多数</span></strong><strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">mysql</span></strong><strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">引擎都支持这种索引，</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">archive</span></strong><strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">引擎是一个例外</span></strong><span style="font-family:Courier New;color:#000000;font-size:16px;">，</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">5.1之前这个引擎不支持任何索引，</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">5.1开始才支持单列自增的索引。</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">innodb使用</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">b+tree=btree（</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">btree已经不使用了）</span></span></span></span></span></span></span><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:宋体;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">存储引擎以不同的方式使用</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">btree索引，性能也各不相同，各有优劣，如</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">:myisam使用前缀压缩技术使得索引更小（但也可能导致连接表查询性能降低），但</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">innodb则按照原数据格式进行存储，再如：</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">myisam索引通过数据的物理位置来引用被索引的行，而</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">innodb则根据主键来引用被索引的行。</span></span></span></span></span></span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">btree通常意味着所有的值都是按照顺序存储的，并且每一个叶子页到根的距离相同</span></span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">，下图是</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">innodb索引工作示意图，</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">myisam使用的结构有所不同，但基本思想类似：</span></span><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><img src="http://images2015.cnblogs.com/blog/763020/201601/763020-20160127192653145-982192619.png" alt="" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;max-width:900px;"></span><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;图片来源于高性能mysql第三版</span><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:宋体;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">btree索引能够加快访问数据的速度，因为存储引擎不再需要进行全表扫描来获取需要的数据，取而代之的是从索引的根节点开始进行搜索，根节点的槽中存放了指向子节点的指针，存储引擎根据这些指针向下层查找</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">,通过比较节点页的值和要查找的值可以找到合适的指针进入下一层子节点，这些指针实际上定义了子节点页中值的上限和下限，最终存储引擎要么是找到对应的值，要么是该记录不存在。</span></span></span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;">叶子节点比较特别，他们的指针指向的是被索引的数据，而不是其他的节点页（不同的引擎指针类型不同），其实在根节点与叶子节点之间可能有很多层节点页，树的深度和表的大小直接相关。</span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;">&nbsp;</span></strong></span><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">btree树索引列是顺序组织存储的，所以很适合查找范围数据，</span></span></strong><span style="font-family:Courier New;color:#000000;font-size:16px;">如</span><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">有表：</span><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">create table people(last_name varchar(50) not null,first_name varchar(50) not null,dob date not null,gender enum(‘m’,’f’) not null,key(last_name,first_name,dob));</span><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">&nbsp;</span><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">对于表中的每一行数据，索引中包含了</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">last_name,first_name,dob列的值，下图显示了该索引是如何组织数据的存储的：</span><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><img src="http://images2015.cnblogs.com/blog/763020/201601/763020-20160127192720848-622482433.png" alt="" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;max-width:900px;"></span><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;图片来源于高性能mysql第三版</span><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:宋体;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">注意：索引对多个值进行排序的依据是</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">create table语句中定义索引时的列顺序，上图中，最后两个值的姓名都一样时，就按照出生日期来排序了。</span></span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;">&nbsp;</span></strong></span><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:宋体;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">可以使用</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">btree索引的查询类型，</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">btree索引使用用于全键值、键值范围、或者键前缀查找，其中键前缀查找只适合用于根据最左前缀的查找。前面示例中创建的多列索引对如下类型的查询有效：</span></span></span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">A：全值匹配</span></span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;">全值匹配指的是和索引中的所有列进行匹配，即可用于查找姓名和出生日期</span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">B：匹配最左前缀</span></span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;">如：只查找姓，即只使用索引的第一列</span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">C：匹配列前缀</span></span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:宋体;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">也可以只匹配某一列值的开头部分，如：匹配以</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">J开头的姓的人，这里也只是使用了索引的第一列，且是第一列的一部分</span></span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">D：匹配范围值</span></span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:宋体;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">如查找姓在</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">allen和</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">barrymore之间的人，这里也只使用了索引的第一列</span></span></span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">E：精确匹配某一列并范围匹配另外一列</span></span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:宋体;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">如查找所有姓为</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">allen，并且名字字母是</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">K开头的，即，第一列</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">last_name精确匹配，第二列</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">first_name范围匹配</span></span></span></span></span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">F：只访问索引的查询</span></span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">btree通常可以支持只访问索引的查询，即查询只需要访问索引，而无需访问数据行，即，这个就是覆盖索引的概念。需要访问的数据直接从索引中取得。</span></span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;">&nbsp;</span></strong></span><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:宋体;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">因为索引树中的节点是有序的，所以除了按值查找之外，索引还可以用于查询中的</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">order by操作，一般来说，如果</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">btree可以按照某种方式查找的值，那么也可以按照这种方式用于排序，所以，如果</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">order by子句满足前面列出的几种查询类型，则这个索引也可以满足对应的排序需求。</span></span></span></span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;">&nbsp;</span></strong></span><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:宋体;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">下面是关于</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">btree索引的限制：</span></span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:宋体;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">A：如果不是按照索引的最左列开始查找的，则无法使用索引</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">(注意，这里不是指的</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">where条件的顺序，即</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">where条件中，不管条件顺序，只要</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">where中出现的列在多列索引中能够从最左开始连贯起来就能使用到多列索引</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">)</span></span></span></span></span></span></span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">B：不能跳过索引中的列，如：查询条件为姓和出生日期，跳过了名字列，这样，多列索引就只能使用到姓这一列</span></span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:宋体;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">C：如果查询中有某个列的范围查询，则其右边所有列都无法使用索引优化查询，如：</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">where last_name=xxx and first_name like ‘xxx%’ and dob=’xxx’;这样，</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">first_name列可以使用索引，这列之后的</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">dob列无法使用索引。</span></span></span></span></span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;">&nbsp;</span></strong></span><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;">哈希索引：</span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;">基于哈希表实现，只有精确匹配索引所有列的查询才有效，对于每一行数据，存储引擎都会对所有的索引列的值计算一个哈希码，哈希码是一个较小的值，并且不同键值的行计算出来的哈希码不一样，哈希索引将所有的哈希码存储在索引中，同时在哈希表中保存指向每个数据行的指针。</span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;">&nbsp;</span></strong></span><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:宋体;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">在</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">mysql中，只有</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">memory引擎显式支持哈希索引，这也是</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">memory引擎表的默认索引类型，</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">memory也支持</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">btree，值得一提的是，</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">memory引擎是支持非唯一哈希索引的。在数据库世界里是比较与众不同，如果多个列的哈希值相同，索引会以链表的方式存放多个记录指针到同一个哈希条目中。</span></span></span></span></span></span></span></strong><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">示例：</span><br>                                    </p><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">mysql&gt;&nbsp;create&nbsp;table&nbsp;testhash(fname&nbsp;varchar(50)&nbsp;not&nbsp;null,lname&nbsp;varchar(50)&nbsp;not&nbsp;null,key&nbsp;using&nbsp;hash(fname))&nbsp;engine=memory;</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">Query&nbsp;OK,&nbsp;0&nbsp;rows&nbsp;affected&nbsp;(0.01&nbsp;sec)</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">mysql&gt;&nbsp;insert&nbsp;into&nbsp;testhash&nbsp;values(‘Arjen’,’Lentz’),(‘Baron’,’Schwartz’),(‘Peter’,’Zaitsev’),(‘Vadim’,’Tkachenko’);</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">Query&nbsp;OK,&nbsp;4&nbsp;rows&nbsp;affected&nbsp;(0.00&nbsp;sec)</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">Records:&nbsp;4&nbsp;&nbsp;Duplicates:&nbsp;0&nbsp;&nbsp;Warnings:&nbsp;0</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">mysql&gt;&nbsp;select&nbsp;<em>&nbsp;from&nbsp;testhash;</em></span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">+——-+———–+</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">|&nbsp;fname&nbsp;|&nbsp;lname&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">+——-+———–+</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">|&nbsp;Arjen&nbsp;|&nbsp;Lentz&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">|&nbsp;Baron&nbsp;|&nbsp;Schwartz&nbsp;&nbsp;|</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">|&nbsp;Peter&nbsp;|&nbsp;Zaitsev&nbsp;&nbsp;&nbsp;|</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">|&nbsp;Vadim&nbsp;|&nbsp;Tkachenko&nbsp;|</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">+——-+———–+</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">4&nbsp;rows&nbsp;in&nbsp;set&nbsp;(0.00&nbsp;sec)</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">假设索引使用假想的哈希函数f(),它返回下面的值：</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">f(‘Arjen’)=2323</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">f(‘Baron’)=7437</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">f(‘Peter’)=8784</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">f(‘Vadim’)=2458</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">则哈希索引的数据结构如下：</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">槽： &nbsp; &nbsp; &nbsp; &nbsp;值：</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">2323 &nbsp; &nbsp; &nbsp; &nbsp;指向第1行的指针</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">2458 &nbsp; &nbsp; &nbsp; &nbsp;指向第4行的指针</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">7437 &nbsp; &nbsp; &nbsp; &nbsp;指向第2行的指针</span><br>                                    </div><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">8784 &nbsp; &nbsp; &nbsp; &nbsp;指向第3行的指针</span><br>                                    </div><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;&nbsp;</span><br>                                    </p><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                            <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;">每个槽的编号是顺序的，但是数据行不是顺序的</span></strong><span style="font-family:Courier New;color:#000000;font-size:16px;">。下面来看一句查询：</span><br>                                        </p><br>                                        <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                            <span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">select lname from testhash where fname=’Peter’;</span><br>                                        </p><br>                                    </div><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">&nbsp;</span><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">mysql先计算</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">Peter的哈希值，并使用该值寻找对应的记录指针，因为</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">f(‘Peter’)=8784，所以</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">mysql在索引中查找</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">8784，可以找到指向第三行的指针，最后一步是比较第三行的值是否为</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">Peter，以确保就是要查找的行。因为索引自身只需要存储对应的哈希值，所以索引的结构十分紧凑，这也让哈希索引查找的速度非常快，然而，哈希索引也有限制，如下：</span></span></span></span></span></span><br>                                    </p><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><br>                                    </p><br>                                </div><br>                                <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                    <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:宋体;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">A：哈希索引只包含哈希值和行指针，而不存储字段值，所以不能使用索引中的值来避免读取行（即不能使用哈希索引来做覆盖索引扫描），不过，访问内存中的行的速度很快（因为</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">memory引擎的数据都保存在内存里），所以大部分情况下这一点对性能的影响并不明显。</span></span></span></strong><br>                                </p><br>                                <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                    <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">B：哈希索引数据并不是按照索引列的值顺序存储的，所以也就无法用于排序</span></span></strong><br>                                </p><br>                                <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                    <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:宋体;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">C：哈希索引也不支持部分索引列匹配查找，因为哈希索引始终是使用索引的全部列值内容来计算哈希值的。如：数据列（</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">a,b）上建立哈希索引，如果只查询数据列</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">a，则无法使用该索引。</span></span></span></span></strong><br>                                </p><br>                                <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                    <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:宋体;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">D：哈希索引只支持等值比较查询，如：</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">=,in(),&lt;=&gt;(注意，</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">&lt;&gt;和</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">&lt;=&gt;是不同的操作</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">)，不支持任何范围查询（必须给定具体的</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">where条件值来计算</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">hash值，所以不支持范围查询）。</span></span></span></span></span></span></span></span></strong><br>                                </p><br>                                <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                    <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">E：访问哈希索引的数据非常快，除非有很多哈希冲突，当出现哈希冲突的时候，存储引擎必须遍历链表中所有的行指针，逐行进行比较，直到找到所有符合条件的行。</span></span></strong><br>                                </p><br>                                <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                    <strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;"><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">F：如果哈希冲突很多的话，一些索引维护操作的代价也很高，如：如果在某个选择性很低的列上建立哈希索引（即很多重复值的列），那么当从表中删除一行时，存储引擎需要遍历对应哈希值的链表中的每一行，找到并删除对应的引用，冲突越多，代价越大。</span></span></strong><br>                                </p><br>                                <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                    <span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><strong style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:courier new;color:#0070C0;font-size:16px;margin:0px;padding:0px;">&nbsp;</span></strong></span><br>                                </p><br>                                <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                    <div style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><br>                                        <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                            <span style="font-family:Courier New;color:#000000;font-size:16px;">从上面描述可知，哈希索引只适合某些特定的场景，而一旦适合哈希索引，则它带来的性能提升非常明显，除了</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">memory引擎外，</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">NDB引擎也支持唯一哈希索引，且</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">NDB存储引擎中作用非常特殊，但这里不讨论。</span></span></span><br>                                        </p><br>                                        <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                            <span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">&nbsp;</span><br>                                        </p><br>                                        <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                            <span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">innodb引擎有一个特殊的功能叫做自适应哈希索引，当</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">innodb注意到某些索引值被使用的非常频繁时，它会在内存中基于</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">btree索引之上再创建一个哈希索引，这样就让</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">btree索引也具有哈希索引的一些优点，比如：快速的哈希查找，这是一个全自动的，内部的行为，用户无法控制或者配置，不过如果有必要，可以选择关闭这个功能（</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">innodb_adaptive_hash_index=OFF，默认为</span><span lang="EN-US" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;">ON）。</span></span></span></span></span></span><br>                                        </p><br>                                    </div><br>                                </div><br>                            </div><br>&lt;div id=”MySignature” style=”font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;color:#393939;font-family:verdana, “ font-size:14px;white-space:normal;background-color:#faf7ef;”=””&gt;<br>                            <p style="font-family:courier new;color:#000000;font-size:16px;margin:0px auto 1em;"><br>                                <span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><br>                            </p><br>                                <br>                                <hr><br>                                <hr><br>                                <div class="postTitle" style="font-family:Verdana, Arial, helvetica, sans-seriff;color:#232323;font-size:13px;font-weight:bold;margin-bottom:10px;white-space:normal;"><br>                                    <a id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/olinux/p/5161826.html" style="font-family:courier new;color:#56B6E9;font-size:16px;text-decoration:none;" target="_blank" rel="external"><span style="font-family:Courier New;color:#000000;font-size:16px;">MySQL中自适应哈希索引</span></a><br>                                </div><br>                                <div id="cnblogs_post_body" style="font-family:Verdana, Arial, helvetica, sans-seriff;color:#232323;font-size:14px;margin-bottom:20px;word-break:break-word;white-space:normal;"><br>                                    <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">自适应哈希索引采用之前讨论的哈希表的方式实现，不同的是，这仅是数据库自身创建并使用的，DBA本身并不能对其进行干预。自适应哈希索引近哈希函数映射到一个哈希表中，因此对于字典类型的查找非常快速，如SELECT  FROM TABLE WHERE index_col=’xxx’但是对于范围查找就无能为力。通过SHOW ENGINE INNODB STATUS 可以看到当前自适应哈希索引的使用情况</span><br>                                    </p><br><div class="cnblogs_code" style="font-family:courier new;color:#000000;font-size:16px;background-color:#F5F5F5;border:1px solid #CCCCCC;padding:5px;overflow:auto;margin:5px 0px;color:#000000;font-size:12px=" "="" !important;"=""><br>                                    <div class="cnblogs_code_toolbar" style="font-family:courier new;color:#000000;font-size:16px;margin-top:5px;"><br>                                        <span style="font-family:Courier New;color:#000000;font-size:16px;">————————————-</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">INSERT BUFFER AND ADAPTIVE HASH INDEX</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">————————————-</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">Ibuf: size 1, free list len 0, seg size 2, 94 merges</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">merged operations:</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;insert 280, delete mark 0, delete 0</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">discarded operations:</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;insert 0, delete mark 0, delete 0</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">Hash table size 4425293, node heap has 1337 buffer(s)</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">174.24 hash searches/s, 169.49 non-hash searches/s</span><span style="font-family:Courier New;color:#000000;font-size:16px;"></span><br><br>                                    </div><br>                                    <div class="cnblogs_code_toolbar" style="font-family:courier new;color:#000000;font-size:16px;margin-top:5px;"><br>                                        <span class="cnblogs_code_copy" style="font-family:courier new;color:#000000;font-size:16px;padding-right:5px;line-height:1.5 !important;"><a title="复制代码" style="font-family:courier new;color:#56B6E9;font-size:16px;border:none !important;"><span style="font-family:Courier New;color:#000000;font-size:16px;"></span></a></span><br>                                    </div><br>                                </div><br>                                <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                    <span style="font-family:Courier New;color:#000000;font-size:16px;">现在可以看到自适应哈希索引的使用信息了。包括自适应哈希索引的大小、使用情况，每秒使用自适应哈希索引搜索的情况。需要注意的是，哈希索引只能用来搜索等值的查询，如</span><br>                                </p><br><div class="cnblogs_code" style="font-family:courier new;color:#000000;font-size:16px;background-color:#F5F5F5;border:1px solid #CCCCCC;padding:5px;overflow:auto;margin:5px 0px;color:#000000;font-size:12px=" "="" !important;"=""><br><pre style="font-family:courier new;color:#000000;font-size:16px;margin-top:0px;margin-bottom:0px;white-space:pre-wrap;"><span style="font-family:courier new;color:#0000FF;font-size:16px;line-height:1.5 !important;">SELECT</span> <span style="font-family:courier new;color:#808080;font-size:16px;line-height:1.5 !important;">*</span> <span style="font-family:courier new;color:#0000FF;font-size:16px;line-height:1.5 !important;">FROM</span> <span style="font-family:courier new;color:#0000FF;font-size:16px;line-height:1.5 !important;">table</span> <span style="font-family:courier new;color:#0000FF;font-size:16px;line-height:1.5 !important;">WHERE</span> <span style="font-family:courier new;color:#FF00FF;font-size:16px;line-height:1.5 !important;">index_col</span><span style="font-family:courier new;color:#808080;font-size:16px;line-height:1.5 !important;">=</span><span style="font-family:courier new;color:#FF0000;font-size:16px;line-height:1.5 !important;">‘</span><span style="font-family:courier new;color:#FF0000;font-size:16px;line-height:1.5 !important;">xxx</span><span style="font-family:courier new;color:#FF0000;font-size:16px;line-height:1.5 !important;">‘</span></pre><br>                            </div><br>                            <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                <span style="font-family:Courier New;color:#000000;font-size:16px;">而对于其他查找类型，如范围查找，是不能使用哈希索引的。因此这里出现no–hash searches的情况，通过hash searches:non-hash searches可以大概了解使用哈希索引后的效率</span><br>                            </p><br>                            <p style="font-family:courier new;color:#000000;font-size:16px;margin:10px auto;"><br>                                <span style="font-family:Courier New;color:#000000;font-size:16px;">由于自适应哈希索引是由InnoDB存储引擎自己控制的，因此这里的这些信息只仅供参考。不过可以通过参数innodb_adaptive_hash_index来禁用或启动此特性，默认是开启</span><br>                            </p><br>                                </div><br><span style="font-family:Courier New;color:#000000;font-size:16px;"></span><br><br>                                <hr><br>                                <hr><br>                                <div style="font-family:courier new;color:#494949;font-size:14px;white-space:normal;background-color:#E7EEF4;"><br>                                    <span style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#000000;font-size:13px;word-wrap:normal;word-break:normal;line-height:13px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">Hash 索引结构的特殊性，其</span><span style="font-family:courier new;color:#FF0000;font-size:16px;word-wrap:normal;word-break:normal;line-height:19.5px;">检索效率非常高，索引的检索可以一次定位，不像B-Tree 索引需要从根节点到枝节点，最后才能访问到页节点这样多次的IO访问，所以 Hash 索引的查询效率要远高于 B-Tree 索引</span><span style="font-family:Courier New;color:#000000;font-size:16px;">。</span></span><br>                                    <p style="font-family:courier new;color:#000000;font-size:13px;margin-right:auto;margin-left:auto;border:0px;list-style:none;word-wrap:normal;word-break:normal;line-height:20px;"><br>                                        <span style="font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#000000;font-size:16px;word-wrap:normal;word-break:normal;line-height:13px;"><span style="font-family:courier new;color:#000000;font-size:14px;word-wrap:normal;word-break:normal;line-height:21px;"><span style="font-family:courier new;color:#000000;font-size:16px;word-wrap:normal;word-break:normal;line-height:21px;"><span style="font-family:courier new;color:#000000;font-size:16px;word-wrap:normal;word-break:normal;line-height:normal;border-collapse:separate;"><span style="font-family:song, Verdana;color:#000000;font-size:16px;word-wrap:normal;word-break:normal;line-height:21px;border-collapse:collapse;"><span style="font-family:Courier New;color:#000000;font-size:16px;">可能很多人又有疑问了，既然 Hash 索引的效率要比 B-Tree 高很多，为什么大家不都用 Hash 索引而还要使用 B-Tree 索引呢？任何事物都是有两面性的，Hash 索引也一样，</span><span style="font-family:courier new;color:#FF0000;font-size:16px;word-wrap:normal;word-break:normal;line-height:21px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">虽然 Hash 索引效率高，但是 Hash 索引本身由于其特殊性也带来了很多</span><b><span style="font-family:Courier New;color:#000000;font-size:16px;">限制和弊端</span></b><span style="font-family:Courier New;color:#000000;font-size:16px;">，主要有以下这些。</span></span><br style="font-family:courier new;color:#000000;font-size:16px;line-height:normal;"><br><br style="font-family:courier new;color:#000000;font-size:16px;line-height:normal;"><br><span style="font-family:courier new;color:#FF0000;font-size:16px;word-wrap:normal;word-break:normal;line-height:21px;">（1）Hash 索引仅仅能满足”=”,”IN”和”&lt;=&gt;”查询，不能使用范围查询。</span><br style="font-family:courier new;color:#000000;font-size:16px;line-height:normal;"><br><br style="font-family:courier new;color:#000000;font-size:16px;line-height:normal;"><br><span style="font-family:courier new;color:#FF0000;font-size:16px;word-wrap:normal;word-break:normal;line-height:21px;">由于 Hash 索引比较的是进行 Hash 运算之后的 Hash 值</span><span style="font-family:Courier New;color:#000000;font-size:16px;">，所以它只能用于</span><span style="font-family:courier new;color:#FF0000;font-size:16px;word-wrap:normal;word-break:normal;line-height:21px;">等值的过滤</span><span style="font-family:Courier New;color:#000000;font-size:16px;">，不能用于基于范围的过滤，因为经过相应的 Hash 算法处理之后的 Hash 值的大小关系，并不能保证和Hash运算前完全一样。</span><br style="font-family:courier new;color:#000000;font-size:16px;line-height:normal;"><br><br style="font-family:courier new;color:#000000;font-size:16px;line-height:normal;"><br><span style="font-family:Courier New;color:#000000;font-size:16px;">（2）</span><span style="font-family:courier new;color:#FF0000;font-size:16px;word-wrap:normal;word-break:normal;line-height:21px;">Hash 索引无法被用来避免数据的排序操作</span><span style="font-family:Courier New;color:#000000;font-size:16px;">。</span><br style="font-family:courier new;color:#000000;font-size:16px;line-height:normal;"><br><br style="font-family:courier new;color:#000000;font-size:16px;line-height:normal;"><br><span style="font-family:courier new;color:#FF0000;font-size:16px;word-wrap:normal;word-break:normal;line-height:21px;">由于 Hash 索引中存放的是经过 Hash 计算之后的 Hash 值，而且Hash值的大小关系并不一定和 Hash 运算前的键值完全一样，</span><span style="font-family:Courier New;color:#000000;font-size:16px;">所以数据库无法利用索引的数据来避免任何排序运算；</span><br style="font-family:courier new;color:#000000;font-size:16px;line-height:normal;"><br><br style="font-family:courier new;color:#000000;font-size:16px;line-height:normal;"><br><span style="font-family:courier new;color:#FF0000;font-size:16px;word-wrap:normal;word-break:normal;line-height:21px;">（3）Hash 索引不能利用部分索引键查询。</span><br style="font-family:courier new;color:#000000;font-size:16px;line-height:normal;"><br><br style="font-family:courier new;color:#000000;font-size:16px;line-height:normal;"><br><span style="font-family:Courier New;color:#000000;font-size:16px;">对于组合索引，Hash 索引在计算 Hash 值的时候是组合索引键合并后再一起计算 Hash 值，而不是单独计算 Hash 值，所以</span><span style="font-family:courier new;color:#FF0000;font-size:16px;word-wrap:normal;word-break:normal;line-height:21px;">通过组合索引的前面一个或几个索引键进行查询的时候，Hash 索引也无法被利用。</span><br style="font-family:courier new;color:#000000;font-size:16px;line-height:normal;"><br><br style="font-family:courier new;color:#000000;font-size:16px;line-height:normal;"><br><span style="font-family:Courier New;color:#000000;font-size:16px;">（4）</span><span style="font-family:courier new;color:#FF0000;font-size:16px;word-wrap:normal;word-break:normal;line-height:21px;">Hash 索引在任何时候都不能避免表扫描。</span><br style="font-family:courier new;color:#000000;font-size:16px;line-height:normal;"><br><br style="font-family:courier new;color:#000000;font-size:16px;line-height:normal;"><br><span style="font-family:Courier New;color:#000000;font-size:16px;">前面已经知道，</span><b><span style="font-family:Courier New;color:#000000;font-size:16px;">Hash 索引</span></b><span style="font-family:Courier New;color:#000000;font-size:16px;">是将索引键通过 Hash 运算之后，将 Hash运算结果的 Hash 值和所对应的行指针信息存放于一个 Hash 表中，</span><span style="font-family:courier new;color:#FF0000;font-size:16px;word-wrap:normal;word-break:normal;line-height:21px;">由于不同索引键存在相同 Hash 值</span><span style="font-family:Courier New;color:#000000;font-size:16px;">，</span><span style="font-family:courier new;color:#FF0000;font-size:16px;word-wrap:normal;word-break:normal;line-height:21px;">所以即使取满足某个 Hash 键值的数据的记录条数，也无法从 Hash 索引中直接完成查询，还是要通过访问表中的实际数据进行相应的比较，并得到相应的结果。</span><br style="font-family:courier new;color:#000000;font-size:16px;line-height:normal;"><br><br style="font-family:courier new;color:#000000;font-size:16px;line-height:normal;"><br><span style="font-family:courier new;color:#FF0000;font-size:16px;word-wrap:normal;word-break:normal;line-height:21px;">（5）Hash 索引遇到大量Hash值相等的情况后性能并不一定就会比B-Tree索引高。</span><br style="font-family:courier new;color:#000000;font-size:16px;line-height:normal;"><br><br style="font-family:courier new;color:#000000;font-size:16px;line-height:normal;"><br><span style="font-family:Courier New;color:#000000;font-size:16px;">对于</span><b><span style="font-family:courier new;color:#FF0000;font-size:16px;word-wrap:normal;word-break:normal;line-height:21px;">选择性</span></b><span style="font-family:Courier New;color:#000000;font-size:16px;">比较低的索引键，如果创建 Hash 索引，那么将会存在大量记录指针信息存于同一个 Hash 值相关联。这样要定位某一条记录时就会非常麻烦，会浪费多次表数据的访问，而造成整体性能低下</span></span></span></span></span></span><br>                                    </p><br>                                </div><br>                                <div style="font-family:courier new;color:#494949;font-size:14px;white-space:normal;background-color:#E7EEF4;"><br>                                    <br><br>                                </div><br>                                <div style="font-family:courier new;color:#494949;font-size:14px;white-space:normal;background-color:#E7EEF4;"><br>                                    <br><br>                                </div><br>                                <div style="font-family:courier new;color:#494949;font-size:14px;white-space:normal;background-color:#E7EEF4;"><br>                                    <span style="font-family:Helvetica, Tahoma, Arial, sans-serif;color:#000000;font-size:16px;word-wrap:normal;word-break:normal;line-height:25px;"><span style="font-family:Courier New;color:#000000;font-size:16px;">2. B-Tree索引&nbsp;</span><br><br><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;B-Tree 索引是 MySQL 数据库中使用最为频繁的索引类型，除了 Archive 存储引擎之外的其他所有的存储引擎都支持 B-Tree 索引。不仅仅在 MySQL 中是如此，实际上在其他的很多数据库管理系统中B-Tree 索引也同样是作为最主要的索引类型，这主要是因为 B-Tree 索引的存储结构在数据库的数据检&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">索中有非常优异的表现。&nbsp;</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;一般来说， MySQL 中的 B-Tree 索引的物理文件大多都是以 Balance Tree 的结构来存储的，也就是所有实际需要的数据都存放于 Tree 的 Leaf Node ，而且到任何一个 Leaf Node 的最短路径的长度都是完全相同的，所以我们大家都称之为 B-Tree 索引当然，可能各种数据库（或 MySQL 的各种存储引擎）在存放自己的 B-Tree 索引的时候会对存储结构稍作改造。如 Innodb 存储引擎的 B-Tree 索引实际使用的存储结构实际上是 B+Tree ，也就是在 B-Tree 数据结构的基础上做了很小的改造，在每一个&nbsp;</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">Leaf Node 上面出了存放索引键的相关信息之外，还存储了指向与该 Leaf Node 相邻的后一个 LeafNode 的指针信息，这主要是为了加快检索多个相邻 Leaf Node 的效率考虑。&nbsp;</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;在 Innodb 存储引擎中，存在两种不同形式的索引，一种是 Cluster 形式的主键索引（ Primary Key ），另外一种则是和其他存储引擎（如 MyISAM 存储引擎）存放形式基本相同的普通 B-Tree 索引，这种索引在 Innodb 存储引擎中被称为 Secondary Index 。下面我们通过图示来针对这两种索引的存放&nbsp;</span><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">形式做一个比较。&nbsp;</span><br><br><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><img src="http://s5.sinaimg.cn/orignal/6776884e07613adee2984&amp;690" real_src="http://s5.sinaimg.cn/orignal/6776884e07613adee2984&amp;690" alt="MySQL的btree索引和hash索引的区别" title="MySQL的btree索引和hash索引的区别" action-data="http%3A%2F%2Fs5.sinaimg.cn%2Forignal%2F6776884e07613adee2984%26690" action-type="show-slide" style="font-family:courier new;color:#000000;font-size:16px;margin:0px;padding:0px;list-style:none;"><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><br><br><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;图示中左边为 Clustered 形式存放的 Primary Key ，右侧则为普通的 B-Tree 索引。两种 Root Node 和 Branch Nodes 方面都还是完全一样的。而 Leaf Nodes 就出现差异了。在 Prim中， Leaf Nodes 存放的是表的实际数据，不仅仅包括主键字段的数据，还包括其他字段的数据据以主键值有序的排列。而 Secondary Index 则和其他普通的 B-Tree 索引没有太大的差异，Leaf Nodes 出了存放索引键 的相关信息外，还存放了 Innodb 的主键值。&nbsp;</span><br><br><br><br><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;</span><span style="font-family:Courier New;color:#000000;font-size:16px;">&nbsp;所以，在 Innodb 中如果通过主键来访问数据效率是非常高的，而如果是通过 Secondary Index 来访问数据的话， Innodb 首先通过 Secondary Index 的相关信息，通过相应的索引键检索到 Leaf Node之后，需要再通过 Leaf Node 中存放的主键值再通过主键索引来获取相应的数据行。MyISAM 存储引擎的主键索引和非主键索引差别很小，只不过是主键索引的索引键是一个唯一且非空 的键而已。而且 MyISAM 存储引擎的索引和 Innodb 的 Secondary Index 的存储结构也基本相同，主要的区别只是 MyISAM 存储引擎在 Leaf Nodes 上面出了存放索引键信息之外，再存放能直接定位到 MyISAM 数据文件中相应的数据行的信息（如 Row Number ），但并不会存放主键的键值信息</span></span><br>                                </div>


      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/11/28/encryptionAlgorithm-01/" rel="next" title="常见加密算法">
                <i class="fa fa-chevron-left"></i> 常见加密算法
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/03/05/jvm-g1/" rel="prev" title="转载:JVM中的G1垃圾回收器">
                转载:JVM中的G1垃圾回收器 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Inhaltsverzeichnis
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Übersicht
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://bloodorange2017.github.io/images/img_head_001.jpg"
               alt="XueCheng" />
          <p class="site-author-name" itemprop="name">XueCheng</p>
           
              <p class="site-description motion-element" itemprop="description">Do one thing at a time, and do well.</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">65</span>
                <span class="site-state-item-name">Artikel</span>
              </a>
            </div>
          

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#0x01hash-index"><span class="nav-number">1.</span> <span class="nav-text"> 0x01.Hash Index    </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#直接索引"><span class="nav-number">1.1.</span> <span class="nav-text"> 直接索引        </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hash-算法"><span class="nav-number">1.2.</span> <span class="nav-text"> Hash 算法                </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#insert-update-select-操作"><span class="nav-number">1.3.</span> <span class="nav-text"> INSERT UPDATE SELECT 操作            </span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x02hash-index-缺点"><span class="nav-number">2.</span> <span class="nav-text"> 0x02.Hash Index 缺点                    </span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#undefined"><span class="nav-number">3.</span> <span class="nav-text">
                                    参考资料 
                                </span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">XueCheng</span>
</div>


<div class="powered-by">
  Erstellt mit  <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  





  

  

  

  

  

<script type="text/javascript"
color="160,160,233" opacity='0.4' zIndex="-2" count="16" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
</body>
</html>
