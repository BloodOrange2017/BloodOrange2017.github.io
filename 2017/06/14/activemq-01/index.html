<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="1.管理ActiveMQ地址 &amp;nbsp;http://localhost:8161/admin/&amp;nbsp; &amp;nbsp; 默认用户和密码：admin=admin运行发送者，eclipse控制台输出，如下图：&amp;nbsp;&amp;nbsp;此时，我们先看一下ActiveMQ服务器，Queues内容如下：&amp;nbsp;我们可以看到创建了一个名称为HelloWorld的消息队列，队列中有10条消息未被消费，我">
<meta property="og:type" content="article">
<meta property="og:title" content="Spring整合ActiveMQ">
<meta property="og:url" content="https://bloodorange2017.github.io/archives/2017/06/14/activemq-01/index.html">
<meta property="og:site_name" content="XueCheng Notes">
<meta property="og:description" content="1.管理ActiveMQ地址 &amp;nbsp;http://localhost:8161/admin/&amp;nbsp; &amp;nbsp; 默认用户和密码：admin=admin运行发送者，eclipse控制台输出，如下图：&amp;nbsp;&amp;nbsp;此时，我们先看一下ActiveMQ服务器，Queues内容如下：&amp;nbsp;我们可以看到创建了一个名称为HelloWorld的消息队列，队列中有10条消息未被消费，我">
<meta property="og:image" content="http://img.blog.csdn.net/20150920173405956">
<meta property="og:image" content="http://img.blog.csdn.net/20150920173620033">
<meta property="og:image" content="http://img.blog.csdn.net/20150920174135335">
<meta property="og:image" content="http://img.blog.csdn.net/20150920174317150">
<meta property="og:image" content="http://img.blog.csdn.net/20150920174417511">
<meta property="og:image" content="http://img.blog.csdn.net/20150920175100179">
<meta property="og:image" content="http://static.open-open.com/lib/uploadImg/20140515/20140515120001_591.png">
<meta property="og:image" content="http://static.open-open.com/lib/uploadImg/20140515/20140515115951_604.png">
<meta property="og:image" content="http://static.open-open.com/lib/uploadImg/20140515/20140515115919_992.png">
<meta property="og:image" content="http://static.open-open.com/lib/uploadImg/20160102/20160102210319_351.png">
<meta property="og:image" content="http://static.open-open.com/lib/uploadImg/20160102/20160102210319_3.png">
<meta property="og:image" content="http://static.open-open.com/lib/uploadImg/20160102/20160102210319_893.png">
<meta property="og:image" content="http://static.open-open.com/lib/uploadImg/20160102/20160102210319_95.png">
<meta property="og:image" content="http://static.oschina.net/uploads/space/2016/0103/194536_ySvR_159239.png">
<meta property="og:image" content="http://static.oschina.net/uploads/space/2016/0103/194609_AlHc_159239.png">
<meta property="og:updated_time" content="2017-06-14T06:19:26.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Spring整合ActiveMQ">
<meta name="twitter:description" content="1.管理ActiveMQ地址 &amp;nbsp;http://localhost:8161/admin/&amp;nbsp; &amp;nbsp; 默认用户和密码：admin=admin运行发送者，eclipse控制台输出，如下图：&amp;nbsp;&amp;nbsp;此时，我们先看一下ActiveMQ服务器，Queues内容如下：&amp;nbsp;我们可以看到创建了一个名称为HelloWorld的消息队列，队列中有10条消息未被消费，我">
<meta name="twitter:image" content="http://img.blog.csdn.net/20150920173405956">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://bloodorange2017.github.io/archives/2017/06/14/activemq-01/"/>





  <title>Spring整合ActiveMQ | XueCheng Notes</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  














  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">XueCheng Notes</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Where there is a will, there is a way.</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Startseite
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archiv
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://bloodorange2017.github.io/archives/2017/06/14/activemq-01/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="XueCheng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://bloodorange2017.github.io/images/img_head_001.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XueCheng Notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Spring整合ActiveMQ</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-06-14T14:17:28+08:00">
                2017-06-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <div id="article_content" class="article_content tracking-ad" data-mod="popu_307" data-dsm="post"><br><br><h1>1.管理ActiveMQ</h1><br><p>地址 &nbsp;<a target="_blank" href="http://localhost:8161/admin/" style="color:rgb(255,153,0); text-decoration:none; font-family:'microsoft yahei'; font-size:14px; line-height:26px">http://localhost:8161/admin/</a></p><br><p>&nbsp; &nbsp; 默认用户和密码：admin=admin</p><br><p></p><br><ol style="font-family:'microsoft yahei'; font-size:14px; line-height:26px"><br><li style=""><br><p style="margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px"><br>运行发送者，eclipse控制台输出，如下图：&nbsp;<br style=""><br><img src="http://img.blog.csdn.net/20150920173405956" alt="这里写图片描述" title="" style="border:none; max-width:100%">&nbsp;<br style=""><br>此时，我们先看一下ActiveMQ服务器，Queues内容如下：&nbsp;<br style=""><br><img src="http://img.blog.csdn.net/20150920173620033" alt="这里写图片描述" title="" style="border:none; max-width:100%"><br style=""><br>我们可以看到创建了一个名称为HelloWorld的消息队列，队列中有10条消息未被消费，我们也可以通过Browse查看是哪些消息，如下图：&nbsp;<br style=""><br><img src="http://img.blog.csdn.net/20150920174135335" alt="这里写图片描述" title="" style="border:none; max-width:100%"><br style=""><br>如果这些队列中的消息，被删除，消费者则无法消费。</p><br></li><li style=""><br><p style="margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px"><br>我们继续运行一下消费者，eclipse控制台打印消息，如下：&nbsp;<br style=""><br><img src="http://img.blog.csdn.net/20150920174317150" alt="这里写图片描述" title="" style="border:none; max-width:100%">&nbsp;<br style=""><br>此时，我们先看一下ActiveMQ服务器，Queues内容如下：&nbsp;<br style=""><br><img src="http://img.blog.csdn.net/20150920174417511" alt="这里写图片描述" title="" style="border:none; max-width:100%"><br style=""><br>我们可以看到HelloWorld的消息队列发生变化，多一个消息者，队列中的10条消息被消费了，点击Browse查看，已经为空了。&nbsp;<br style=""><br>点击Active Consumers，我们可以看到这个消费者的详细信息：&nbsp;<br style=""><br><img src="http://img.blog.csdn.net/20150920175100179" alt="这里写图片描述" title="" style="border:none; max-width:100%"></p><br></li></ol><br><br><br><p></p><br><p><br><br></p><br><h1>2.Spring整合ActiveMQ</h1><br><h2>&nbsp; &nbsp;1.maven</h2><br><div>&nbsp; &nbsp; &nbsp; &nbsp;<pre code_snippet_id="1660918" snippet_file_name="blog_20160425_1_1952419" name="code" class="html">&lt;!–ActiveMQ依赖 –&gt;<br>        &lt;dependency&gt;<br>            &lt;groupId&gt;org.apache.activemq&lt;/groupId&gt;<br>            &lt;artifactId&gt;activemq-all&lt;/artifactId&gt;<br>            &lt;version&gt;5.13.2&lt;/version&gt;<br>        &lt;/dependency&gt;<br>&lt;!– Spring整合ActiveMQ所需依赖 –&gt;<br>            &lt;dependency&gt;<br>                &lt;groupId&gt;org.springframework&lt;/groupId&gt;<br>                &lt;artifactId&gt;spring-jms&lt;/artifactId&gt;<br>            &lt;/dependency&gt;<br>            &lt;dependency&gt;<br>                &lt;groupId&gt;org.springframework&lt;/groupId&gt;<br>                &lt;artifactId&gt;spring-messaging&lt;/artifactId&gt;<br>            &lt;/dependency&gt;</pre><br><br><br><br><br><br><br><br></div><br><h2>&nbsp; &nbsp;2.ActiveMQ配置文件</h2><br><div><pre code_snippet_id="1660918" snippet_file_name="blog_20160425_2_1712439" name="code" class="html">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br>&lt;beans xmlns=&quot;<a href="http://www.springframework.org/schema/beans&amp;quot" target="_blank" rel="external">http://www.springframework.org/schema/beans&amp;quot</a>;<br>    xmlns:context=&quot;<a href="http://www.springframework.org/schema/context&amp;quot" target="_blank" rel="external">http://www.springframework.org/schema/context&amp;quot</a>;<br>    xmlns:xsi=&quot;<a href="http://www.w3.org/2001/XMLSchema-instance&amp;quot" target="_blank" rel="external">http://www.w3.org/2001/XMLSchema-instance&amp;quot</a>; xmlns:amq=&quot;<a href="http://activemq.apache.org/schema/core&amp;quot" target="_blank" rel="external">http://activemq.apache.org/schema/core&amp;quot</a>;<br>    xmlns:jms=&quot;<a href="http://www.springframework.org/schema/jms&amp;quot" target="_blank" rel="external">http://www.springframework.org/schema/jms&amp;quot</a>;<br>    xsi:schemaLocation=&quot;<a href="http://www.springframework.org/schema/beans" target="_blank" rel="external">http://www.springframework.org/schema/beans</a><br>        <a href="http://www.springframework.org/schema/beans/spring-beans-4.0.xsd" target="_blank" rel="external">http://www.springframework.org/schema/beans/spring-beans-4.0.xsd</a><br>        <a href="http://www.springframework.org/schema/context" target="_blank" rel="external">http://www.springframework.org/schema/context</a><br>        <a href="http://www.springframework.org/schema/context/spring-context-4.0.xsd" target="_blank" rel="external">http://www.springframework.org/schema/context/spring-context-4.0.xsd</a><br>        <a href="http://www.springframework.org/schema/jms" target="_blank" rel="external">http://www.springframework.org/schema/jms</a><br>        <a href="http://www.springframework.org/schema/jms/spring-jms-4.0.xsd" target="_blank" rel="external">http://www.springframework.org/schema/jms/spring-jms-4.0.xsd</a><br>        <a href="http://activemq.apache.org/schema/core" target="_blank" rel="external">http://activemq.apache.org/schema/core</a><br>        <a href="http://activemq.apache.org/schema/core/activemq-core-5.8.0.xsd&quot;&amp;gt" target="_blank" rel="external">http://activemq.apache.org/schema/core/activemq-core-5.8.0.xsd&quot;&amp;gt</a>;<br><br>    &lt;!– ActiveMQ 连接工厂 –&gt;<br>    &lt;!– 真正可以产生Connection的ConnectionFactory，由对应的 JMS服务厂商提供–&gt;<br>    &lt;!– 如果连接网络：tcp://ip:61616；未连接网络：tcp://localhost:61616 以及用户名，密码–&gt;<br>    &lt;amq:connectionFactory id=&quot;amqConnectionFactory&quot;<br>        brokerURL=&quot;tcp://172.17.65.29:61616&quot; userName=&quot;admin&quot; password=&quot;admin&quot;  /&gt;<br><br>    &lt;!– Spring Caching连接工厂 –&gt;<br>    &lt;!– Spring用于管理真正的ConnectionFactory的ConnectionFactory –&gt;<br>    &lt;bean id=&quot;connectionFactory&quot; class=&quot;org.springframework.jms.connection.CachingConnectionFactory&quot;&gt;<br>        &lt;!– 目标ConnectionFactory对应真实的可以产生JMS Connection的ConnectionFactory –&gt;<br>        &lt;property name=&quot;targetConnectionFactory&quot; ref=&quot;amqConnectionFactory&quot;&gt;&lt;/property&gt;<br>        &lt;!– 同上，同理 –&gt;<br>        &lt;!– &lt;constructor-arg ref=&quot;amqConnectionFactory&quot; /&gt; –&gt;<br>        &lt;!– Session缓存数量 –&gt;<br>        &lt;property name=&quot;sessionCacheSize&quot; value=&quot;100&quot; /&gt;<br>    &lt;/bean&gt;<br><br>    &lt;!– Spring JmsTemplate 的消息生产者 start–&gt;<br><br>    &lt;!– 定义JmsTemplate的Queue类型 –&gt;<br>    &lt;bean id=&quot;jmsQueueTemplate&quot; class=&quot;org.springframework.jms.core.JmsTemplate&quot;&gt;<br>        &lt;!– 这个connectionFactory对应的是我们定义的Spring提供的那个ConnectionFactory对象 –&gt;<br>        &lt;constructor-arg ref=&quot;connectionFactory&quot; /&gt;<br>        &lt;!– 非pub/sub模型（发布/订阅），即队列模式 –&gt;<br>        &lt;property name=&quot;pubSubDomain&quot; value=&quot;false&quot; /&gt;<br>    &lt;/bean&gt;<br><br>    &lt;!– 定义JmsTemplate的Topic类型 –&gt;<br>    &lt;bean id=&quot;jmsTopicTemplate&quot; class=&quot;org.springframework.jms.core.JmsTemplate&quot;&gt;<br>         &lt;!– 这个connectionFactory对应的是我们定义的Spring提供的那个ConnectionFactory对象 –&gt;<br>        &lt;constructor-arg ref=&quot;connectionFactory&quot; /&gt;<br>        &lt;!– pub/sub模型（发布/订阅） –&gt;<br>        &lt;property name=&quot;pubSubDomain&quot; value=&quot;true&quot; /&gt;<br>    &lt;/bean&gt;<br><br>    &lt;!–Spring JmsTemplate 的消息生产者 end–&gt;<br><br><br>    &lt;!– 消息消费者 start–&gt;<br><br>    &lt;!– 定义Queue监听器 –&gt;<br>    &lt;jms:listener-container destination-type=&quot;queue&quot; container-type=&quot;default&quot; connection-factory=&quot;connectionFactory&quot; acknowledge=&quot;auto&quot;&gt;<br>        &lt;jms:listener destination=&quot;test.queue&quot; ref=&quot;queueReceiver1&quot;/&gt;<br>        &lt;jms:listener destination=&quot;test.queue&quot; ref=&quot;queueReceiver2&quot;/&gt;<br>    &lt;/jms:listener-container&gt;<br><br>    &lt;!– 定义Topic监听器 –&gt;<br>    &lt;jms:listener-container destination-type=&quot;topic&quot; container-type=&quot;default&quot; connection-factory=&quot;connectionFactory&quot; acknowledge=&quot;auto&quot;&gt;<br>        &lt;jms:listener destination=&quot;test.topic&quot; ref=&quot;topicReceiver1&quot;/&gt;<br>        &lt;jms:listener destination=&quot;test.topic&quot; ref=&quot;topicReceiver2&quot;/&gt;<br>    &lt;/jms:listener-container&gt;<br><br>    &lt;!– 消息消费者 end –&gt;<br>&lt;/beans&gt;  </pre><br><br><h2>3.生产者</h2><br></div><br><h3>1.queue消息队列模式</h3><br><div><br><br></div><br><div><pre code_snippet_id="1660918" snippet_file_name="blog_20160425_3_2410550" name="code" class="java">package com.jay.mq.demo1.producer.queue;<br><br><br>import javax.jms.JMSException;<br>import javax.jms.Message;<br>import javax.jms.Session;<br><br><br>import org.springframework.beans.factory.annotation.Autowired;<br>import org.springframework.beans.factory.annotation.Qualifier;<br>import org.springframework.jms.core.JmsTemplate;<br>import org.springframework.jms.core.MessageCreator;<br>import org.springframework.stereotype.Component;<br><br><br>/<strong><br>&#160;<em> ActiveMQ的消息队列模式<br>&#160;</em> Description: &lt;br/&gt;<br>&#160;<em> 队列消息的生产者，发哦是哪个消息到队列<br>&#160;</em> @author hetiewei<br>&#160;<em> @date 2016年4月25日 上午10:20:20<br>&#160;</em><br>&#160;*/<br>@Component(&quot;queueSender&quot;)<br>public class QueueSender1 {<br>&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt;<br>&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt;/</strong><br>&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt; <em> 通过Qualifier来注入对应的Bean<br>&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt; </em>/<br>&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt;@Autowired<br>&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt;@Qualifier(&quot;jmsQueueTemplate&quot;)<br>&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt;private JmsTemplate jmsTemplate;<br>&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt;<br>&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt;/<strong><br>&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt; <em> Description: &lt;br/&gt;<br>&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt; </em> 发送消息到指定的队列(目标)<br>&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt; <em> @author hetiewei<br>&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt; </em> @date 2016年4月25日 上午10:24:57<br>&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt; <em> @param queueName &#160;队列名称<br>&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt; </em> @param message &#160; &#160;消息内容<br>&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt; */<br>&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt;public void send(String queueName, final String message){<br>&lt;span style=&quot;white-space:pre&quot;&gt;        &lt;/span&gt;jmsTemplate.send(queueName, new MessageCreator() {<br>&lt;span style=&quot;white-space:pre&quot;&gt;            &lt;/span&gt;<br>&lt;span style=&quot;white-space:pre&quot;&gt;            &lt;/span&gt;public Message createMessage(Session session) throws JMSException {<br>&lt;span style=&quot;white-space:pre&quot;&gt;                &lt;/span&gt;return session.createTextMessage(message);<br>&lt;span style=&quot;white-space:pre&quot;&gt;            &lt;/span&gt;}<br>&lt;span style=&quot;white-space:pre&quot;&gt;        &lt;/span&gt;});<br>&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt;}<br>}<br></strong></pre><br><h3><br><br><br><br>2.&nbsp;topic/sub订阅模式</h3><br></div><br><div><pre code_snippet_id="1660918" snippet_file_name="blog_20160425_4_2552254" name="code" class="java">package com.jay.mq.demo1.producer.topic;<br><br>import javax.jms.JMSException;<br>import javax.jms.Message;<br>import javax.jms.Session;<br><br>import org.springframework.beans.factory.annotation.Autowired;<br>import org.springframework.beans.factory.annotation.Qualifier;<br>import org.springframework.jms.core.JmsTemplate;<br>import org.springframework.jms.core.MessageCreator;<br>import org.springframework.stereotype.Component;<br><br>/<br> <em> ActiveMQ的topic/sub模式
 </em> Description: &lt;br/&gt;<br> <em> Topic生产者发送消息到Topic
 </em> @author hetiewei<br> <em> @date 2016年4月25日 上午11:22:40
 </em><br> <em>/<br>@Component<br>public class TopicSender1 {<br><br>    @Autowired<br>    @Qualifier(&quot;jmsTopicTemplate&quot;)<br>    private JmsTemplate jmsTemplate;<br><br>    /**
     </em> 发送一条消息到指定的队列（目标）<br>     <em> @param queueName 队列名称
     </em> @param message 消息内容<br>     <em>/<br>    public void send(String topicName,final String message){<br>        jmsTemplate.send(topicName, new MessageCreator() {<br><br>            public Message createMessage(Session session) throws JMSException {<br>                return session.createTextMessage(message);<br>            }<br>        });<br>    }<br><br>}<br></em></pre><br><br><br><br></div><br><h2>4.消费者</h2><br><h3>1.queue消息队列模式</h3><br><div><pre code_snippet_id="1660918" snippet_file_name="blog_20160425_5_3250365" name="code" class="java">package com.jay.mq.demo1.consumer.queue;<br><br>import javax.jms.JMSException;<br>import javax.jms.Message;<br>import javax.jms.MessageListener;<br>import javax.jms.TextMessage;<br><br>import org.springframework.stereotype.Component;<br><br>/**
  Description: &lt;br/&gt;<br> <em> 消息队列监听器
 </em> @author hetiewei<br> <em> @date 2016年4月25日 上午10:32:14
 </em><br> <em>/<br>@Component<br>public class QueueReceiver1 implements MessageListener {<br><br>    public void onMessage(Message message) {<br>        try {<br>            System.out.println(&quot;QueueReceiver1接收到消息：&quot;+((TextMessage)message).getText());<br>        } catch (JMSException e) {<br>            e.printStackTrace();<br>        }<br>    }<br><br>}<br></em></pre><br><br><br><br></div><br><div><pre code_snippet_id="1660918" snippet_file_name="blog_20160425_6_3915457" name="code" class="java">package com.jay.mq.demo1.consumer.queue;<br><br>import javax.jms.JMSException;<br>import javax.jms.Message;<br>import javax.jms.MessageListener;<br>import javax.jms.TextMessage;<br><br>import org.springframework.stereotype.Component;<br><br>/**
  Description: &lt;br/&gt;<br> <em> 消息队列监听器
 </em> @author hetiewei<br> <em> @date 2016年4月25日 上午10:32:14
 </em><br> <em>/<br>@Component<br>public class QueueReceiver2 implements MessageListener {<br><br>    public void onMessage(Message message) {<br>        try {<br>            System.out.println(&quot;QueueReceiver2接收到消息：&quot;+((TextMessage)message).getText());<br>        } catch (JMSException e) {<br>            e.printStackTrace();<br>        }<br>    }<br><br>}<br></em></pre><br><br><br><br></div><br><h3>2.topic/sub订阅模式</h3><br><div><br><br></div><br><div><pre code_snippet_id="1660918" snippet_file_name="blog_20160425_7_6249771" name="code" class="java">package com.jay.mq.demo1.consumer.topic;<br><br>import javax.jms.JMSException;<br>import javax.jms.Message;<br>import javax.jms.MessageListener;<br>import javax.jms.TextMessage;<br><br>import org.springframework.stereotype.Component;<br><br>@Component<br>public class TopicReceiver1 implements MessageListener{<br><br>    public void onMessage(Message message) {<br>        try {<br>            System.out.println(&quot;TopicReceiver1接收到消息:&quot;+((TextMessage)message).getText());<br>        } catch (JMSException e) {<br>            e.printStackTrace();<br>        }<br>    }<br><br>}<br></pre><br><br><br><br></div><br><div><pre code_snippet_id="1660918" snippet_file_name="blog_20160425_8_4755272" name="code" class="java">package com.jay.mq.demo1.consumer.topic;<br><br>import javax.jms.JMSException;<br>import javax.jms.Message;<br>import javax.jms.MessageListener;<br>import javax.jms.TextMessage;<br><br>import org.springframework.stereotype.Component;<br><br>@Component<br>public class TopicReceiver2 implements MessageListener{<br><br>    public void onMessage(Message message) {<br>        try {<br>            System.out.println(&quot;TopicReceiver2接收到消息:&quot;+((TextMessage)message).getText());<br>        } catch (JMSException e) {<br>            e.printStackTrace();<br>        }<br>    }<br><br>}<br></pre><br><h2></h2><br><h2>5.Controller</h2><br><div><pre code_snippet_id="1660918" snippet_file_name="blog_20160425_9_993281" name="code" class="java">package com.jay.controller.demo1;<br><br>import javax.annotation.Resource;<br><br>import org.springframework.beans.factory.annotation.Autowired;<br>import org.springframework.stereotype.Controller;<br>import org.springframework.web.bind.annotation.RequestMapping;<br>import org.springframework.web.bind.annotation.RequestParam;<br>import org.springframework.web.bind.annotation.ResponseBody;<br><br>import com.jay.mq.demo1.producer.queue.QueueSender1;<br>import com.jay.mq.demo1.producer.topic.TopicSender1;<br><br>/**
  Description: &lt;br/&gt;<br> <em> 
 </em> @author hetiewei<br> <em> @date 2016年4月25日 上午10:35:31
 </em><br> <em>/<br>@Controller<br>@RequestMapping(&quot;activemq&quot;)<br>public class ActivemqController1 {<br><br>    @Resource<br>    private QueueSender1 queueSender;<br>    @Autowired<br>    private TopicSender1 topicSender;<br><br>    /**
     </em> 发送消息到队列<br>     <em> Queue队列：仅有一个订阅者会收到消息，消息一旦被处理就不会存在队列中
     </em> @param message<br>     <em> @return String
     </em>/<br>    @ResponseBody<br>    @RequestMapping(&quot;queueSender&quot;)<br>    public String queueSender(@RequestParam(&quot;message&quot;)String message){<br>        String opt=&quot;&quot;;<br>        try {<br>            queueSender.send(&quot;test.queue&quot;, message);<br>            opt = &quot;suc&quot;;<br>        } catch (Exception e) {<br>            opt = e.getCause().toString();<br>        }<br>        return opt;<br>    }<br><br>    @ResponseBody<br>    @RequestMapping(&quot;topicSender&quot;)<br>    public String topoicSender(@RequestParam(&quot;message&quot;)String message){<br>        String opt = &quot;&quot;;<br>        try {<br>            topicSender.send(&quot;test.topic&quot;, message);<br>            opt = &quot;suc&quot;;<br>        } catch (Exception e) {<br>            opt = e.getCause().toString();<br>        }<br>        return opt;<br>    }<br><br><br>}<br></pre><br><h1><br><br><br><br>3.<span style="color:rgb(64,64,64); line-height:25.2px; font-family:Cambria; font-size:14px">ActiveMQ</span><span style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:1.3em; line-height:1.1">的多种部署方式</span></h1><br></div><br></div><br><div><br><p align="left" style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>单点的<span style="line-height:25.2px; font-family:Calibri">ActiveMQ</span>作为企业应用无法满足高可用和集群的需求，所以<span style="line-height:25.2px; font-family:Calibri">ActiveMQ</span>提供了<span style="line-height:25.2px; font-family:Calibri">master-slave</span>、<span style="line-height:25.2px; font-family:Calibri">broker<br> cluster</span>等多种部署方式，但通过分析多种部署方式之后我认为需要将两种部署方式相结合才能满足我们公司分布式和高可用的需求，所以后面就重点将解如何将两种部署方式相结合。</p><br><h5 style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-weight:500; line-height:1.1; color:rgb(64,64,64); margin-top:10px; margin-bottom:10px; font-size:14px"><br><a target="_blank" name="t7" style="color:rgb(136,136,136); background-color:transparent"></a><span style="line-height:25.2px">1、Master-Slave部署方式</span></h5><br><h6 style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-weight:500; line-height:1.1; color:rgb(64,64,64); margin-top:10px; margin-bottom:10px; font-size:12px"><br><a target="_blank" name="t8" style="color:rgb(136,136,136); background-color:transparent"></a><span style="line-height:21.6px">1）shared filesystem Master-Slave部署方式</span></h6><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>主要是通过共享存储目录来实现<span style="line-height:25.2px; font-family:Calibri">master</span>和<span style="line-height:25.2px; font-family:Calibri">slave</span>的热备，所有的<span style="line-height:25.2px; font-family:Calibri">ActiveMQ</span>应用都在不断地获取共享目录的控制权，哪个应用抢到了控制权，它就成为<span style="line-height:25.2px; font-family:Calibri">master</span>。</p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>多个共享存储目录的应用，谁先启动，谁就可以最早取得共享目录的控制权成为<span style="line-height:25.2px; font-family:Calibri">master</span>，其他的应用就只能作为<span style="line-height:25.2px; font-family:Calibri">slave</span>。</p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><img title="p2.png" border="0" alt="p2.png" src="http://static.open-open.com/lib/uploadImg/20140515/20140515120001_591.png" width="323" height="250" style="border:0px; vertical-align:middle; max-width:100%"></p><br><h6 style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-weight:500; line-height:1.1; color:rgb(64,64,64); margin-top:10px; margin-bottom:10px; font-size:12px"><br><a target="_blank" name="t9" style="color:rgb(136,136,136); background-color:transparent"></a><span style="line-height:21.6px">2）shared database Master-Slave方式</span></h6><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>与<span style="line-height:25.2px; font-family:Calibri">shared filesystem</span>方式类&#20284;，只是共享的存储介质由文件系统改成了数据库而已。</p><br><h6 style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-weight:500; line-height:1.1; color:rgb(64,64,64); margin-top:10px; margin-bottom:10px; font-size:12px"><br><a target="_blank" name="t10" style="color:rgb(136,136,136); background-color:transparent"></a><span style="line-height:21.6px">3）Replicated LevelDB Store方式</span></h6><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>这种主备方式是<span style="line-height:25.2px; font-family:Calibri">ActiveMQ5.9</span>以后才新增的特性，使用<span style="line-height:25.2px; font-family:Calibri">ZooKeeper</span>协调选择一个<span style="line-height:25.2px; font-family:Calibri">node</span>作为<span style="line-height:25.2px; font-family:Calibri">master</span>。被选择的<span style="line-height:25.2px; font-family:Calibri">master<br> broker node</span>开启并接受客户端连接。</p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px">其他<span style="line-height:25.2px; font-family:Calibri">node</span>转入<span style="line-height:25.2px; font-family:Calibri">slave</span>模式，连接<span style="line-height:25.2px; font-family:Calibri">master</span>并同步他们的存储状态。<span style="line-height:25.2px; font-family:Calibri">slave</span>不接受客户端连接。所有的存储操作都将被复制到连接至<span style="line-height:25.2px; font-family:Calibri">Master</span>的<span style="line-height:25.2px; font-family:Calibri">slaves</span>。</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px">如果<span style="line-height:25.2px; font-family:Calibri">master</span>死了，得到了最新更新的<span style="line-height:25.2px; font-family:Calibri">slave</span>被允许成为<span style="line-height:25.2px; font-family:Calibri">master</span>。<span style="line-height:25.2px; font-family:Calibri">fialed<br> node</span>能够重新加入到网络中并连接<span style="line-height:25.2px; font-family:Calibri">master</span>进入<span style="line-height:25.2px; font-family:Calibri">slave mode</span>。所有需要同步的<span style="line-height:25.2px; font-family:Calibri">disk</span>的消息操作都将等待存储状态被复制到其他法定节点的操作完成才能完成。所以，如果你配置了<span style="line-height:25.2px; font-family:Calibri">replicas=3</span>，那么法定大小是<span style="line-height:25.2px; font-family:Calibri">(3/2)&#43;1=2.<br> Master</span>将会存储并更新然后等待<span style="line-height:25.2px; font-family:Calibri">&nbsp;(2-1)=1</span>个<span style="line-height:25.2px; font-family:Calibri">slave</span>存储和更新完成，才汇报<span style="line-height:25.2px; font-family:Calibri">success</span>。至于为什么是<span style="line-height:25.2px; font-family:Calibri">2-1</span>，熟悉<span style="line-height:25.2px; font-family:Calibri">Zookeeper</span>的应该知道，有一个<span style="line-height:25.2px; font-family:Calibri">node</span>要作为观擦者存在。</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px">单一个新的<span style="line-height:25.2px; font-family:Calibri">master</span>被选中，你需要至少保障一个法定<span style="line-height:25.2px; font-family:Calibri">node</span>在线以能够找到拥有最新状态的<span style="line-height:25.2px; font-family:Calibri">node</span>。这个<span style="line-height:25.2px; font-family:Calibri">node</span>将会成为新的<span style="line-height:25.2px; font-family:Calibri">master</span>。因此，推荐运行至少<span style="line-height:25.2px; font-family:Calibri">3</span>个<span style="line-height:25.2px; font-family:Calibri">replica<br> nodes</span>，以防止一个<span style="line-height:25.2px; font-family:Calibri">node</span>失败了，服务中断。</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><img title="p3.png" border="0" alt="p3.png" src="http://static.open-open.com/lib/uploadImg/20140515/20140515115951_604.png" width="328" height="153" style="border:0px; vertical-align:middle; max-width:100%"></p><br><h5 style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-weight:500; line-height:1.1; color:rgb(64,64,64); margin-top:10px; margin-bottom:10px; font-size:14px"><br><a target="_blank" name="t11" style="color:rgb(136,136,136); background-color:transparent"></a><span style="line-height:25.2px">2、Broker-Cluster部署方式</span></h5><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>前面的<span style="line-height:25.2px; font-family:Calibri">Master-Slave</span>的方式虽然能解决多服务热备的高可用问题，但无法解决负载均衡和分布式的问题。<span style="line-height:25.2px; font-family:Calibri">Broker-Cluster</span>的部署方式就可以解决负载均衡的问题。</p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Broker-Cluster</span>部署方式中，各个<span style="line-height:25.2px; font-family:Calibri">broker</span>通过网络互相连接，并共享<span style="line-height:25.2px; font-family:Calibri">queue</span>。当<span style="line-height:25.2px; font-family:Calibri">broker-A</span>上面指定的<span style="line-height:25.2px; font-family:Calibri">queue-A</span>中接收到一个<span style="line-height:25.2px; font-family:Calibri">message</span>处于<span style="line-height:25.2px; font-family:Calibri">pending</span>状态，而此时没有<span style="line-height:25.2px; font-family:Calibri">consumer</span>连接<span style="line-height:25.2px; font-family:Calibri">broker-A</span>时。如果<span style="line-height:25.2px; font-family:Calibri">cluster</span>中的<span style="line-height:25.2px; font-family:Calibri">broker-B</span>上面由一个<span style="line-height:25.2px; font-family:Calibri">consumer</span>在消费<span style="line-height:25.2px; font-family:Calibri">queue-A</span>的消息，那么<span style="line-height:25.2px; font-family:Calibri">broker-B</span>会先通过内部网络获取到<span style="line-height:25.2px; font-family:Calibri">broker-A</span>上面的<span style="line-height:25.2px; font-family:Calibri">message</span>，并通知自己的<span style="line-height:25.2px; font-family:Calibri">consumer</span>来消费。</p><br><h6 style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-weight:500; line-height:1.1; color:rgb(64,64,64); margin-top:10px; margin-bottom:10px; font-size:12px"><br><a target="_blank" name="t12" style="color:rgb(136,136,136); background-color:transparent"></a><span style="line-height:21.6px">1）static Broker-Cluster部署</span></h6><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>在<span style="line-height:25.2px; font-family:Calibri">activemq.xml</span>文件中静态指定<span style="line-height:25.2px; font-family:Calibri">Broker</span>需要建立桥连接的其他<span style="line-height:25.2px; font-family:Calibri">Broker</span>：</p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">1、</span>&nbsp;&nbsp;<span style="line-height:25.2px">首先在<span style="line-height:25.2px; font-family:Calibri">Broker-A</span>节点中添加<span style="line-height:25.2px; font-family:Calibri">networkConnector</span>节点：</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;networkConnectors&gt;&nbsp;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;networkConnector&nbsp;&nbsp; uri=&quot;static:(tcp:// 0.0.0.0:61617)&quot;duplex=&quot;false&quot;/&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;/networkConnectors&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">2、</span>&nbsp;&nbsp;<span style="line-height:25.2px">修改<span style="line-height:25.2px; font-family:Calibri">Broker-A</span>节点中的服务提供端口为<span style="line-height:25.2px; font-family:Calibri">61616</span>：</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;transportConnectors&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;transportConnectorname=&quot;openwire&quot;uri=&quot;tcp://0.0.0.0:61616?maximumConnections=1000&amp;amp;wireFormat.maxFrameSize=104857600&quot;/&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;/transportConnectors&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">3、</span>&nbsp;&nbsp;<span style="line-height:25.2px">在<span style="line-height:25.2px; font-family:Calibri">Broker-B</span>节点中添加<span style="line-height:25.2px; font-family:Calibri">networkConnector</span>节点：</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;networkConnectors&gt;&nbsp;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;networkConnector&nbsp;&nbsp; uri=&quot;static:(tcp:// 0.0.0.0:61616)&quot;duplex=&quot;false&quot;/&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;/networkConnectors&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">4、</span>&nbsp;&nbsp;<span style="line-height:25.2px">修改<span style="line-height:25.2px; font-family:Calibri">Broker-A</span>节点中的服务提供端口为<span style="line-height:25.2px; font-family:Calibri">61617</span>：</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;transportConnectors&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;transportConnectorname=&quot;openwire&quot;uri=&quot;tcp://0.0.0.0:61617?maximumConnections=1000&amp;amp;wireFormat.maxFrameSize=104857600&quot;/&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;/transportConnectors&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">5</span>、分别启动<span style="line-height:25.2px; font-family:Calibri">Broker-A</span>和<span style="line-height:25.2px; font-family:Calibri">Broker-B</span>。</p><br><h6 style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-weight:500; line-height:1.1; color:rgb(64,64,64); margin-top:10px; margin-bottom:10px; font-size:12px"><br><a target="_blank" name="t13" style="color:rgb(136,136,136); background-color:transparent"></a><span style="line-height:21.6px">2）Dynamic Broker-Cluster部署</span></h6><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>在<span style="line-height:25.2px; font-family:Calibri">activemq.xml</span>文件中不直接指定<span style="line-height:25.2px; font-family:Calibri">Broker</span>需要建立桥连接的其他<span style="line-height:25.2px; font-family:Calibri">Broker</span>，由<span style="line-height:25.2px; font-family:Calibri">activemq</span>在启动后动态查找：</p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">1、</span>&nbsp;&nbsp;<span style="line-height:25.2px">首先在<span style="line-height:25.2px; font-family:Calibri">Broker-A</span>节点中添加<span style="line-height:25.2px; font-family:Calibri">networkConnector</span>节点：</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;networkConnectors&gt;&nbsp;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;networkConnectoruri=&quot;multicast://default&quot;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dynamicOnly=&quot;true&quot;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;networkTTL=&quot;3&quot;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prefetchSize=&quot;1&quot;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decreaseNetworkConsumerPriority=&quot;true&quot; /&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;/networkConnectors&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">2</span>、修改<span style="line-height:25.2px; font-family:Calibri">Broker-A</span>节点中的服务提供端口为<span style="line-height:25.2px; font-family:Calibri">61616</span>：</p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;transportConnectors&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;transportConnectorname=&quot;openwire&quot;uri=&quot;tcp://0.0.0.0:61616? &quot; discoveryUri=&quot;multicast://default&quot;/&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;/transportConnectors&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">3</span>、在<span style="line-height:25.2px; font-family:Calibri">Broker-B</span>节点中添加<span style="line-height:25.2px; font-family:Calibri">networkConnector</span>节点：</p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;networkConnectors&gt;&nbsp;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;networkConnectoruri=&quot;multicast://default&quot;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dynamicOnly=&quot;true&quot;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;networkTTL=&quot;3&quot;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prefetchSize=&quot;1&quot;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decreaseNetworkConsumerPriority=&quot;true&quot; /&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;/networkConnectors&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">4</span>、修改<span style="line-height:25.2px; font-family:Calibri">Broker-B</span>节点中的服务提供端口为<span style="line-height:25.2px; font-family:Calibri">61617</span>：</p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;transportConnectors&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;transportConnectorname=&quot;openwire&quot;uri=&quot;tcp://0.0.0.0:61617&quot; discoveryUri=&quot;multicast://default&quot;/&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;/transportConnectors&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">5</span>、启动<span style="line-height:25.2px; font-family:Calibri">Broker-A</span>和<span style="line-height:25.2px; font-family:Calibri">Broker-B</span></p><br><h5 style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-weight:500; line-height:1.1; color:rgb(64,64,64); margin-top:10px; margin-bottom:10px; font-size:14px"><br><a target="_blank" name="t14" style="color:rgb(136,136,136); background-color:transparent"></a><span style="line-height:25.2px">2、Master-Slave与<span style="line-height:25.2px; font-family:Calibri">Broker-Cluster</span>相结合的部署方式</span></h5><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>可以看到<span style="line-height:25.2px; font-family:Calibri">Master-Slave</span>的部署方式虽然解决了高可用的问题，但不支持负载均衡，<span style="line-height:25.2px; font-family:Calibri">Broker-Cluster</span>解决了负载均衡，但当其中一个<span style="line-height:25.2px; font-family:Calibri">Broker</span>突然宕掉的话，那么存在于该<span style="line-height:25.2px; font-family:Calibri">Broker</span>上处于<span style="line-height:25.2px; font-family:Calibri">Pending</span>状态的<span style="line-height:25.2px; font-family:Calibri">message</span>将会丢失，无法达到高可用的目的。</p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>由于目前<span style="line-height:25.2px; font-family:Calibri">ActiveMQ</span>官网上并没有一个明确的将两种部署方式相结合的部署方案，所以我尝试者把两者结合起来部署：</p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img title="p4.png" border="0" alt="p4.png" src="http://static.open-open.com/lib/uploadImg/20140515/20140515115919_992.png" width="636" height="361" style="border:0px; vertical-align:middle; max-width:100%"></span></p><br><h6 style="font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-weight:500; line-height:1.1; color:rgb(64,64,64); margin-top:10px; margin-bottom:10px; font-size:12px"><br><a target="_blank" name="t15" style="color:rgb(136,136,136); background-color:transparent"></a><span style="line-height:21.6px">1、部署的配置修改</span></h6><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>这里以<span style="line-height:25.2px; font-family:Calibri">Broker-A &#43; Broker-B</span>建立<span style="line-height:25.2px; font-family:Calibri">cluster</span>，<span style="line-height:25.2px; font-family:Calibri">Broker-C</span>作为<span style="line-height:25.2px; font-family:Calibri">Broker-B</span>的<span style="line-height:25.2px; font-family:Calibri">slave</span>为例：</p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">1）</span>首先在<span style="line-height:25.2px; font-family:Calibri">Broker-A</span>节点中添加<span style="line-height:25.2px; font-family:Calibri">networkConnector</span>节点：</p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;networkConnectors&gt;&nbsp;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;networkConnector&nbsp;&nbsp; uri=&quot;<span style="line-height:25.2px; color:red">masterslave:(tcp://0.0.0.0:61617,tcp:// 0.0.0.0:61618</span>)&quot; duplex=&quot;false&quot;/&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;/networkConnectors&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">2）</span>修改<span style="line-height:25.2px; font-family:Calibri">Broker-A</span>节点中的服务提供端口为<span style="line-height:25.2px; font-family:Calibri">61616</span>：</p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;transportConnectors&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;transportConnectorname=&quot;openwire&quot;uri=&quot;tcp://0.0.0.0:61616?maximumConnections=1000&amp;amp;wireFormat.maxFrameSize=104857600&quot;/&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;/transportConnectors&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">3）</span>在<span style="line-height:25.2px; font-family:Calibri">Broker-B</span>节点中添加<span style="line-height:25.2px; font-family:Calibri">networkConnector</span>节点：</p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;networkConnectors&gt;&nbsp;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;networkConnector&nbsp;&nbsp; uri=&quot;static:(tcp:// 0.0.0.0:61616)&quot;duplex=&quot;false&quot;/&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;/networkConnectors&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">4）</span>修改<span style="line-height:25.2px; font-family:Calibri">Broker-B</span>节点中的服务提供端口为<span style="line-height:25.2px; font-family:Calibri">61617</span>：</p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;transportConnectors&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;transportConnectorname=&quot;openwire&quot;uri=&quot;tcp://0.0.0.0:61617?maximumConnections=1000&amp;amp;wireFormat.maxFrameSize=104857600&quot;/&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;/transportConnectors&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">5）</span><span style="line-height:25.2px">修改<span style="line-height:25.2px; font-family:Calibri">Broker-B</span>节点中的持久化方式：</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;persistenceAdapter&gt;</p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;kahaDB directory=&quot;<span style="line-height:25.2px; color:red">/localhost/kahadb</span>&quot;/&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&lt;/persistenceAdapter&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">6）</span>在<span style="line-height:25.2px; font-family:Calibri">Broker-C</span>节点中添加<span style="line-height:25.2px; font-family:Calibri">networkConnector</span>节点：</p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;networkConnectors&gt;&nbsp;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;networkConnector&nbsp;&nbsp; uri=&quot;static:(tcp:// 0.0.0.0:61616)&quot;duplex=&quot;false&quot;/&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;/networkConnectors&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">7）</span>修改<span style="line-height:25.2px; font-family:Calibri">Broker-C</span>节点中的服务提供端口为<span style="line-height:25.2px; font-family:Calibri">61618</span>：</p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;transportConnectors&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;transportConnectorname=&quot;openwire&quot;uri=&quot;tcp://0.0.0.0:61618?maximumConnections=1000&amp;amp;wireFormat.maxFrameSize=104857600&quot;/&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&lt;/transportConnectors&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">8）</span>修改<span style="line-height:25.2px; font-family:Calibri">Broker-B</span>节点中的持久化方式：</p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;persistenceAdapter&gt;</p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;kahaDB directory=&quot;<span style="line-height:25.2px; color:red">/localhost/kahadb</span>&quot;/&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/persistenceAdapter&gt;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:Calibri">9）</span>分别启动<span style="line-height:25.2px; font-family:Calibri">broker-A</span>、<span style="line-height:25.2px; font-family:Calibri">broker-B</span>、<span style="line-height:25.2px; font-family:Calibri">broker-C</span>，因为是<span style="line-height:25.2px; font-family:Calibri">broker-B</span>先启动，所以“<span style="line-height:25.2px; font-family:Calibri">/localhost/kahadb</span>”目录被<span style="line-height:25.2px; font-family:Calibri">lock</span>住，<span style="line-height:25.2px; font-family:Calibri">broker-C</span>将一直处于挂起状态，当人为停掉<span style="line-height:25.2px; font-family:Calibri">broker-B</span>之后，<span style="line-height:25.2px; font-family:Calibri">broker-C</span>将获取目录“<span style="line-height:25.2px; font-family:Calibri">/localhost/kahadb</span>”的控制权，重新与<span style="line-height:25.2px; font-family:Calibri">broker-A</span>组成<span style="line-height:25.2px; font-family:Calibri">cluster</span>提供服务。</p><br><br><br></div><br><h1><br><br>4.ActiveMQ之Master-Slaver&#43;负载均衡</h1><br><div><br><br></div><br><div><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br>什么叫中间件?<br style="line-height:10px"><br>中间件为软件应用提供了操作系统所提供的服务之外的服务，可以把中间件描述为&quot;软件胶水&quot;。中间件不是操作系统的一部分，不是数据库操作系统，也不是应用软件的一部分，而是能够让软件开发者方便的处理通信、输入和输出，能够专注自己应用的部分。</p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; color:rgb(76,51,229)">消息中间件解决了应用之间的消息传递、解耦、异步的问题。</span><br style="line-height:10px"><br><span style="line-height:1.5">ActiveMQ 是Apache出品，最流行的，能力强劲的开源消息总线。ActiveMQ 是一个完全支持JMS1.1和J2EE 1.4规范的 JMS Provider实现，尽管JMS规范出台已经是很久的事情了，但是JMS在当今的J2EE应用中间仍然扮演着特殊的地位。</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:1.5">一般中间件都提供了横向扩展和纵向扩展，<span style="line-height:25.2px">横向扩展就是我们经常说的<span style="line-height:25.2px; color:rgb(76,51,229)">负载均衡</span></span>,<span style="line-height:25.2px">纵向扩展提供了<span style="line-height:25.2px; color:rgb(76,51,229)">Master-Slaver</span></span>;</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:1.5"><span style="line-height:25.2px; color:rgb(76,51,229)">负载均衡:<span style="line-height:25.2px; color:rgb(0,0,0)">提供</span></span>负载均衡的中间件都对外提供服务<br style="line-height:10px"><br><span style="line-height:25.2px; color:rgb(76,51,229)">Master-Slaver：<span style="line-height:25.2px; color:rgb(0,0,0)">同时只有一个中间件对外提供服务,当Master出现挂机等问题，Slaver会自动接管</span></span><br style="line-height:10px"><br></span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:1.5"><span style="line-height:25.2px; color:rgb(76,51,229)"><span style="line-height:25.2px; color:rgb(0,0,0)">看一个整合的简图:<br style="line-height:10px"><br><img alt="" src="http://static.open-open.com/lib/uploadImg/20160102/20160102210319_351.png" width="509" height="308" style="border:0px; vertical-align:middle; max-width:100%"><br style="line-height:10px"><br></span></span></span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:1.5"><span style="line-height:25.2px; color:rgb(76,51,229)">Master-Slave和Broker Cluster</span></span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px">准备：<br style="line-height:10px"><br>jdk1.6，apache-activemq-5.10.0，mysql5.1，zookeeper-3.4.3</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:1.5"><span style="line-height:25.2px; color:rgb(76,51,229)"><span style="line-height:25.2px; color:rgb(0,0,0)">先来看看<span style="line-height:25.2px; color:rgb(76,51,229)">Master-Slave<span style="line-height:25.2px; color:rgb(0,0,0)">模式</span></span></span></span></span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:1.5"><span style="line-height:25.2px; color:rgb(76,51,229)">Shared File System Master Slave</span></span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:1.5"><span style="line-height:25.2px; color:rgb(76,51,229)"><span style="line-height:25.2px; color:rgb(0,0,0)">本次测试在同一台机器上：<br style="line-height:10px"><br>首先更改配置conf/activemq,做如下修改：<br style="line-height:10px"><br></span></span></span></p><br><pre class="brush:java; toolbar: true; auto-links: false;" style="overflow:auto; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; padding:6px; margin-top:0px; margin-bottom:10px; line-height:1.45; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word; border:none; background-color:rgb(246,246,246)">&lt;persistenceAdapter&gt;<br>        &lt;!–&lt;kahaDB directory=&quot;${activemq.data}/kahadb&quot;/&gt;–&gt;<br>    &lt;kahaDB directory=&quot;D:/kahaDB&quot;/&gt;<br> &lt;/persistenceAdapter&gt;</pre><br><span style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px">将activemq拷贝3份，分别：apache-activemq-5.10.0-M1，&nbsp;</span><span style="line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px">apache-activemq-5.10.0-M2，<span style="line-height:25.2px">apache-activemq-5.10.0-M3</span></span><span style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px">，分别启动activemq命令，启动的日志分别是:&nbsp;</span><br style="line-height:10px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><img alt="" src="http://static.open-open.com/lib/uploadImg/20160102/20160102210319_3.png" width="644" height="69" style="border:0px; vertical-align:middle; max-width:100%; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px"><span style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px"></span><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:1.5"><span style="line-height:25.2px; color:rgb(76,51,229)"><span style="line-height:25.2px; color:rgb(0,0,0)">表示当前进程是Master<br style="line-height:10px"><br><br style="line-height:10px"><br><img alt="" src="http://static.open-open.com/lib/uploadImg/20160102/20160102210319_893.png" width="643" height="72" style="border:0px; vertical-align:middle; max-width:100%"><br style="line-height:10px"><br></span></span></span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:1.5"><span style="line-height:25.2px; color:rgb(76,51,229)"><span style="line-height:25.2px; color:rgb(0,0,0)">表示当前进程没有获取到锁，作为Slaver<br style="line-height:10px"><br></span></span></span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:1.5"><span style="line-height:25.2px; color:rgb(76,51,229)"><span style="line-height:25.2px; color:rgb(0,0,0)">测试：</span></span></span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px">下面的例子中分别提供了<span style="line-height:25.2px; color:rgb(76,51,229)">Producer<span style="line-height:25.2px; color:rgb(0,0,0)">(Sender类)</span></span>和<span style="line-height:25.2px; color:rgb(76,51,229)">Consumer<span style="line-height:25.2px; color:rgb(0,0,0)">(Receiver类)<br style="line-height:10px"><br>我们首先用Producer发送消息给activemq，然后停止Master，然后再用Consumer接受消息，测试结果是可以接受到数据的。</span></span></span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px"><span style="line-height:25.2px; color:rgb(76,51,229)"><span style="line-height:25.2px; color:rgb(0,0,0)">2）.<span style="line-height:25.2px; color:rgb(76,51,229)">JDBC Master Slave</span><span style="line-height:25.2px; color:rgb(76,51,229)"><br style="line-height:10px"><br><span style="line-height:25.2px; color:rgb(0,0,0)">JDBC Master Slave模式和Shared File Sysytem Master Slave模式的原理是一样的，只是把共享文件系统换成了共享数据库。</span></span></span></span></span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px"><span style="line-height:25.2px; color:rgb(76,51,229)"><span style="line-height:25.2px; color:rgb(0,0,0)"><span style="line-height:25.2px; color:rgb(76,51,229)"><span style="line-height:25.2px; color:rgb(0,0,0)">修改配置文件conf/activemq<br style="line-height:10px"><br></span></span></span></span></span></p><br><pre class="brush:java; toolbar: true; auto-links: false;" style="overflow:auto; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; padding:6px; margin-top:0px; margin-bottom:10px; line-height:1.45; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word; border:none; background-color:rgb(246,246,246)"><pre code_snippet_id="1660918" snippet_file_name="blog_20160425_10_9093290" name="code" class="html">&lt;persistenceAdapter&gt;<br>        &lt;!–&lt;kahaDB directory=&quot;${activemq.data}/kahadb&quot;/&gt;–&gt;<br>    &lt;!–&lt;kahaDB directory=&quot;D:/kahaDB&quot;/&gt;–&gt;<br>        &lt;jdbcPersistenceAdapter dataDirectory=&quot;${activemq.base}/data&quot; dataSource=&quot;#mysql-ds&quot;/&gt;<br>  &lt;/persistenceAdapter&gt;</pre><br><br></pre><br><span style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px">添加数据源：</span><br><pre class="brush:java; toolbar: true; auto-links: false;" style="overflow:auto; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; padding:6px; margin-top:0px; margin-bottom:10px; line-height:1.45; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word; border:none; background-color:rgb(246,246,246)"><pre code_snippet_id="1660918" snippet_file_name="blog_20160425_11_1808506" name="code" class="html">&lt;bean id=&quot;mysql-ds&quot; class=&quot;org.apache.commons.dbcp.BasicDataSource&quot; destroy-method=&quot;close&quot;&gt;<br>    &lt;property name=&quot;driverClassName&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt;<br>    &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost/activemq?relaxAutoCommit=true&quot;/&gt;<br>    &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;<br>    &lt;property name=&quot;password&quot; value=&quot;root&quot;/&gt;<br>    &lt;property name=&quot;poolPreparedStatements&quot; value=&quot;true&quot;/&gt;<br>    &lt;/bean&gt;</pre><br><br></pre><br><span style="line-height:25.2px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; color:rgb(229,51,51)">注：这里使用的是mysql，所以需要mysql驱动程序：</span><span style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px">&nbsp;</span><span style="line-height:25.2px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; color:rgb(229,51,51)">mysql-connector-java-5.1.18，讲jar包放入lib文件夹下面，驱动版本不对，会出现如下错误:</span><span style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px">&nbsp;</span><span style="line-height:25.2px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; color:rgb(229,51,51)">Database<br> lock driver override not found for : [mysql_connect</span><span style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px">&nbsp;</span><span style="line-height:25.2px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; color:rgb(229,51,51)">…</span><span style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px"></span><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><br style="line-height:10px"><br></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:1.5">分别拷贝到其他几个文件夹下，分别启动，启动成功后我们可以看到数据库中多了几张表：</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px"><span style="line-height:25.2px; color:rgb(76,51,229)"><span style="line-height:25.2px; color:rgb(0,0,0)"><span style="line-height:25.2px; color:rgb(76,51,229)"><span style="line-height:25.2px; color:rgb(0,0,0)"><img alt="" src="http://static.open-open.com/lib/uploadImg/20160102/20160102210319_95.png" width="318" height="148" style="border:0px; vertical-align:middle; max-width:100%"><br style="line-height:10px"><br></span></span></span></span></span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px"><span style="line-height:25.2px; color:rgb(76,51,229)"><span style="line-height:25.2px; color:rgb(0,0,0)"><span style="line-height:25.2px; color:rgb(76,51,229)"><span style="line-height:25.2px; color:rgb(0,0,0)">测试方式同上；<br style="line-height:10px"><br>官网手册:<a target="_blank" href="http://activemq.apache.org/jdbc-master-slave.html" rel="nofollow" style="color:rgb(0,95,169); text-decoration:none; background-color:transparent">http://activemq.apache.org/jdbc-master-slave.html</a></span></span></span></span></span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px"><span style="line-height:25.2px; color:rgb(76,51,229)"><span style="line-height:25.2px; color:rgb(0,0,0)"><span style="line-height:25.2px; color:rgb(76,51,229)"><span style="line-height:25.2px; color:rgb(0,0,0)">3).<span style="line-height:25.2px; color:rgb(76,51,229)">Replicated<br> LevelDB Store</span><br style="line-height:10px"><br><span style="line-height:25px; color:rgb(64,64,64); background-color:rgb(250,250,250)">这种方式是</span><span style="line-height:25px; font-family:Calibri; color:rgb(64,64,64); background-color:rgb(250,250,250)">ActiveMQ5.9</span><span style="line-height:25px; color:rgb(64,64,64); background-color:rgb(250,250,250)">以后才新增的特性，使用</span><span style="line-height:25px; font-family:Calibri; color:rgb(64,64,64); background-color:rgb(250,250,250)">ZooKeeper</span><span style="line-height:25px; color:rgb(64,64,64); background-color:rgb(250,250,250)">协调选择一个</span><span style="line-height:25px; font-family:Calibri; color:rgb(64,64,64); background-color:rgb(250,250,250)">node</span><span style="line-height:25px; color:rgb(64,64,64); background-color:rgb(250,250,250)">作为</span><span style="line-height:25px; font-family:Calibri; color:rgb(64,64,64); background-color:rgb(250,250,250)">master</span></span></span></span></span></span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px"><span style="line-height:25.2px; color:rgb(76,51,229)"><span style="line-height:25.2px; color:rgb(0,0,0)"><span style="line-height:25.2px; color:rgb(76,51,229)"><span style="line-height:25.2px; color:rgb(0,0,0)"><span style="line-height:25.2px">修改配置文件conf/activemq：<br style="line-height:10px"><br></span></span></span></span></span></span></p><br><pre class="brush:java; toolbar: true; auto-links: false;" style="overflow:auto; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; padding:6px; margin-top:0px; margin-bottom:10px; line-height:1.45; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word; border:none; background-color:rgb(246,246,246)"><pre code_snippet_id="1660918" snippet_file_name="blog_20160425_12_5047109" name="code" class="html">&lt;!–&lt;persistenceAdapter&gt;<br>         &lt;kahaDB directory=&quot;${activemq.data}/kahadb&quot;/&gt;<br>         &lt;kahaDB directory=&quot;D:/kahaDB&quot;/&gt;<br>         &lt;jdbcPersistenceAdapter dataDirectory=&quot;${activemq.base}/data&quot; dataSource=&quot;#mysql-ds&quot;/&gt;<br> &lt;/persistenceAdapter&gt;–&gt;<br> &lt;persistenceAdapter&gt;<br>    &lt;replicatedLevelDB<br>        directory=&quot;${activemq.data}/leveldb&quot;<br>        replicas=&quot;3&quot;<br>        bind=&quot;tcp://0.0.0.0:0&quot;<br>        zkAddress=&quot;127.0.0.1:2181&quot;<br>        hostname=&quot;127.0.0.1&quot;<br>        sync=&quot;local_disk&quot;<br>        zkPath=&quot;/activemq/leveldb-stores&quot;/&gt;<br> &lt;/persistenceAdapter&gt;</pre><br><br></pre><br><span style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px">首先启动zookeeper，这里没有做集群处理,默认端口是2181，然后分别启动activemq，&nbsp;</span><br style="line-height:10px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px; font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; color:rgb(229,51,51)">启动之后报错：&quot;activemq LevelDB IOException handler&quot;。</span><span style="color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px; line-height:25.2px">&nbsp;</span><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px"><span style="line-height:25.2px; color:rgb(76,51,229)"><span style="line-height:25.2px; color:rgb(0,0,0)"><span style="line-height:25.2px; color:rgb(76,51,229)"><span style="line-height:25.2px; color:rgb(0,0,0)"><span style="line-height:25.2px; color:rgb(229,51,51)"><span style="line-height:22px; font-family:'Microsoft YaHei',Verdana,sans-serif,宋体; color:rgb(51,51,51)">原因：版本5.10.0存在的依赖冲突。</span><br style="line-height:10px"><br></span></span></span></span></span></span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(51,51,51); font-size:14px; font-family:'Microsoft YaHei',Verdana,sans-serif,宋体"><br><span style="line-height:28.8px; font-size:16px"><span style="line-height:25.2px; font-size:14px">解决方案：<br style="line-height:10px"><br></span></span><span style="line-height:1.5">（1）移除lib目录中的pax-url-aether-1.5.2.jar包<br style="line-height:10px"><br></span><span style="line-height:28.8px; font-size:16px"><span style="line-height:25.2px; font-size:14px">（2）注释掉配置文件中的日志配置；</span></span><span style="line-height:25.2px">&nbsp;</span></p><br><pre class="brush:java; toolbar: true; auto-links: false;" style="overflow:auto; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; padding:6px; margin-top:0px; margin-bottom:10px; line-height:1.45; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word; border:none; background-color:rgb(246,246,246)">&lt;!– Allows accessing the server log<br>    &lt;bean id=&quot;logQuery&quot; class=&quot;org.fusesource.insight.log.log4j.Log4jLogQuery&quot;<br>          lazy-init=&quot;false&quot; scope=&quot;singleton&quot;<br>          init-method=&quot;start&quot; destroy-method=&quot;stop&quot;&gt;<br>    &lt;/bean&gt;<br>–&gt;</pre><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:25.2px">测试方式同上；</span></p><br><p style="margin-top:10px; margin-bottom:10px; line-height:25.2px; color:rgb(64,64,64); font-family:'Microsoft YaHei',Verdana,sans-serif,SimSun; font-size:14px"><br><span style="line-height:1.5"><span style="line-height:25.2px; color:rgb(76,51,229)"><span style="line-height:25.2px; color:rgb(0,0,0)">提供java版的例子：<br style="line-height:10px"><br></span></span></span></p><br><pre class="brush:java; toolbar: true; auto-links: false;" style="overflow:auto; font-family:Menlo,Monaco,Consolas,'Courier New',monospace; padding:6px; margin-top:0px; margin-bottom:10px; line-height:1.45; color:rgb(51,51,51); word-break:break-all; word-wrap:break-word; border:none; background-color:rgb(246,246,246)"><pre code_snippet_id="1660918" snippet_file_name="blog_20160425_13_2397151" name="code" class="java">public class Sender {<br>    private static final int SEND_NUMBER = 5;<br><br>    public static void main(String[] args) {<br>        ConnectionFactory connectionFactory;<br>        Connection connection = null;<br>        Session session;<br>        Destination destination;<br>        MessageProducer producer;<br>        connectionFactory = new ActiveMQConnectionFactory(<br>            ActiveMQConnection.DEFAULT_USER,<br>            ActiveMQConnection.DEFAULT_PASSWORD, &quot;tcp://localhost:61616&quot;);<br>        try {<br>            connection = connectionFactory.createConnection();<br>            connection.start();<br>            session = connection.createSession(Boolean.TRUE,<br>                    Session.AUTO_ACKNOWLEDGE);<br>            destination = session.createQueue(&quot;FirstQueue&quot;);<br>            producer = session.createProducer(destination);<br>            producer.setDeliveryMode(DeliveryMode.PERSISTENT);<br>            sendMessage(session, producer);<br>            session.commit();<br>        } catch (Exception e) {<br>            e.printStackTrace();<br>        } finally {<br>            try {<br>                if (null != connection)<br>                    connection.close();<br>            } catch (Throwable ignore) {<br>            }<br>        }<br>    }<br><br>    public static void sendMessage(Session session, MessageProducer producer)<br>            throws Exception {<br>        for (int i = 1; i &lt;= SEND_NUMBER; i++) {<br>            TextMessage message = session.createTextMessage(&quot;发送的消息&quot;<br>                    + i);<br>            System.out.println(&quot;发送消息：&quot; + &quot;ActiveMq 发送的消息&quot; + i);<br>            producer.send(message);<br>        }<br>    }<br>}<br>public class Receiver {<br>    public static void main(String[] args) {<br>        ConnectionFactory connectionFactory;<br>        Connection connection = null;<br>        Session session;<br>        Destination destination;<br>        MessageConsumer consumer;<br>        connectionFactory = new ActiveMQConnectionFactory(<br>            ActiveMQConnection.DEFAULT_USER,<br>            ActiveMQConnection.DEFAULT_PASSWORD, &quot;tcp://localhost:61616&quot;);<br>        try {<br>            connection = connectionFactory.createConnection();<br>            connection.start();<br>            session = connection.createSession(Boolean.FALSE,<br>                    Session.AUTO_ACKNOWLEDGE);<br>            destination = session.createQueue(&quot;FirstQueue&quot;);<br>            consumer = session.createConsumer(destination);<br>            while (true) {<br>                TextMessage message = (TextMessage) consumer.receive(100000);<br>                if (null != message) {<br>                    System.out.println(&quot;收到消息&quot; + message.getText());<br>                } else {<br>                    break;<br>                }<br>            }<br>        } catch (Exception e) {<br>            e.printStackTrace();<br>        } finally {<br>            try {<br>                if (null != connection)<br>                    connection.close();<br>            } catch (Throwable ignore) {<br>            }<br>        }<br>    }<br>}</pre><br><br></pre><br><h1 style="padding-top:0px; padding-bottom:0px; margin-top:8px; margin-bottom:8px; line-height:22.5px; letter-spacing:0.5px; font-size:12.5px; word-wrap:break-word; word-break:break-all; color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体"><br><br><br><h1><span style="padding:0px; margin:0px; color:rgb(76,51,229)">5.Broker-Cluster实现负载均衡</span></h1><br></h1><br></div><br><div><br><p style="padding-top:0px; padding-bottom:0px; margin-top:8px; margin-bottom:8px; line-height:22.5px; letter-spacing:0.5px; font-size:12.5px; word-wrap:break-word; word-break:break-all; color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体"><br><span style="padding:0px; margin:0px; font-family:'Microsoft YaHei',微软雅黑,Arial,'Lucida Grande',Tahoma,sans-serif; font-size:13px; line-height:24.05px">Broker-Cluster部署方式中，各个broker通过网络互相连接，并共享queue，提供了2中部署方式：<br style="padding:0px; margin:0px"><br><span style="padding:0px; margin:0px; color:rgb(76,51,229)">static Broker-Cluster</span><span style="padding:0px; margin:0px; color:rgb(76,51,229)"></span>和<span style="padding:0px; margin:0px; color:rgb(76,51,229)">Dynamic Broker-Cluster</span><span style="padding:0px; margin:0px; color:rgb(76,51,229)"></span></span></p><br><p style="padding-top:0px; padding-bottom:0px; margin-top:8px; margin-bottom:8px; line-height:22.5px; letter-spacing:0.5px; font-size:12.5px; word-wrap:break-word; word-break:break-all; color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体"><br><span style="padding:0px; margin:0px"><span style="padding:0px; margin:0px; font-size:13px; line-height:24.05px; color:rgb(76,51,229)">1).static Broker-Cluster</span></span></p><br><p style="padding-top:0px; padding-bottom:0px; margin-top:8px; margin-bottom:8px; line-height:22.5px; letter-spacing:0.5px; font-size:12.5px; word-wrap:break-word; word-break:break-all; color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体"><br><span style="padding:0px; margin:0px"><span style="padding:0px; margin:0px; font-size:13px; line-height:24.05px">将ActiveMq拷贝2份，分别命名:apache-activemq-5.10.0_M1,apache-activemq-5.10.0_M2，<br style="padding:0px; margin:0px"><br>下面就是配置activemq,xml:<br style="padding:0px; margin:0px"><br>M1做如下配置:<br style="padding:0px; margin:0px"><br></span></span></p><br><div style="padding:0px; margin:0px; color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体; font-size:12.5px; line-height:22.5px"><br><div id="highlighter_483577" class="syntaxhighlighter  java" style="padding:0px; width:704px; margin:1em 0px!important; position:relative!important; overflow:auto!important; font-size:1em!important"><br><div class="toolbar" style="padding:0px!important; margin:0px!important; border:none!important; bottom:auto!important; float:none!important; height:11px!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:absolute!important; right:1px!important; top:1px!important; vertical-align:baseline!important; width:11px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:10px!important; min-height:auto!important; z-index:10!important; color:white!important; background:rgb(108,226,108)!important"><br><span style="padding:0px; margin:0px"><a target="_blank" href="http://my.oschina.net/OutOfMemory/blog/596552#" class="toolbar_item command_help help" style="padding:1px 0px 0px!important; margin:0px!important; color:white!important; outline:0px!important; font-size:1em!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; overflow:visible!important; position:static!important; right:auto!important; text-align:center!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; display:block!important; text-decoration:none!important; background:none!important">?</a></span></div><br><table border="0" cellpadding="0" cellspacing="0" style="width:704px; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><tbody style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><tr style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><td class="gutter" style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; min-height:auto!important; color:rgb(175,175,175)!important; background:none!important"><br><div class="line number1 index0 alt2" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>1</div><br><div class="line number2 index1 alt1" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>2</div><br><div class="line number3 index2 alt2" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>3</div><br></td><br><td class="code" style="width:675px; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><div class="container" style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:relative!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><div class="line number1 index0 alt2" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&lt;networkConnectors&gt;</code></div><br><div class="line number2 index1 alt1" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java spaces" style="color:red; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&lt;networkConnector<br> uri=</code><code class="java string" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; color:blue!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&quot;static:(tcp://localhost:61617)&quot;</code><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">/&gt;</code></div><br><div class="line number3 index2 alt2" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&lt;/networkConnectors&gt;</code></div><br></div><br></td><br></tr><br></tbody><br></table><br></div><br></div><br><div style="padding:0px; margin:0px; color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体; font-size:12.5px; line-height:22.5px"><br><div id="highlighter_774067" class="syntaxhighlighter  java" style="padding:0px; width:704px; margin:1em 0px!important; position:relative!important; overflow:auto!important; font-size:1em!important"><br><div class="toolbar" style="padding:0px!important; margin:0px!important; border:none!important; bottom:auto!important; float:none!important; height:11px!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:absolute!important; right:1px!important; top:1px!important; vertical-align:baseline!important; width:11px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:10px!important; min-height:auto!important; z-index:10!important; color:white!important; background:rgb(108,226,108)!important"><br><span style="padding:0px; margin:0px"><a target="_blank" href="http://my.oschina.net/OutOfMemory/blog/596552#" class="toolbar_item command_help help" style="padding:1px 0px 0px!important; margin:0px!important; color:white!important; outline:0px!important; font-size:1em!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; overflow:visible!important; position:static!important; right:auto!important; text-align:center!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; display:block!important; text-decoration:none!important; background:none!important">?</a></span></div><br><table border="0" cellpadding="0" cellspacing="0" style="width:1024px; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><tbody style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><tr style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><td class="gutter" style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; min-height:auto!important; color:rgb(175,175,175)!important; background:none!important"><br><div class="line number1 index0 alt2" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>1</div><br><div class="line number2 index1 alt1" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>2</div><br><div class="line number3 index2 alt2" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>3</div><br></td><br><td class="code" style="width:995px; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><div class="container" style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:relative!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><div class="line number1 index0 alt2" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&lt;transportConnectors&gt;</code></div><br><div class="line number2 index1 alt1" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java spaces" style="color:red; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&lt;transportConnector<br> name=</code><code class="java string" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; color:blue!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&quot;openwire&quot;</code><br><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br>uri=</code><code class="java string" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; color:blue!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&quot;tcp://0.0.0.0:61616?maximumConnectio&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> ns=1000&amp;amp;wireFormat.maxFrameSize=104857600&quot;</code><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">/&gt;</code></div><br><div class="line number3 index2 alt2" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java spaces" style="color:red; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&nbsp;</code><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&lt;/transportConnectors&gt;</code></div><br></div><br></td><br></tr><br></tbody><br></table><br></div><br></div><br><span style="padding:0px; margin:0px; color:rgb(51,51,51); font-family:'Microsoft YaHei',微软雅黑,Arial,'Lucida Grande',Tahoma,sans-serif; font-size:13px; line-height:24.05px">M2做如下配置:</span><span style="color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体; font-size:12.5px; line-height:22.5px">&nbsp;</span><br style="padding:0px; margin:0px; color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体; font-size:12.5px; line-height:22.5px"><br><div style="padding:0px; margin:0px; color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体; font-size:12.5px; line-height:22.5px"><br><div id="highlighter_592019" class="syntaxhighlighter  java" style="padding:0px; width:704px; margin:1em 0px!important; position:relative!important; overflow:auto!important; font-size:1em!important"><br><div class="toolbar" style="padding:0px!important; margin:0px!important; border:none!important; bottom:auto!important; float:none!important; height:11px!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:absolute!important; right:1px!important; top:1px!important; vertical-align:baseline!important; width:11px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:10px!important; min-height:auto!important; z-index:10!important; color:white!important; background:rgb(108,226,108)!important"><br><span style="padding:0px; margin:0px"><a target="_blank" href="http://my.oschina.net/OutOfMemory/blog/596552#" class="toolbar_item command_help help" style="padding:1px 0px 0px!important; margin:0px!important; color:white!important; outline:0px!important; font-size:1em!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; overflow:visible!important; position:static!important; right:auto!important; text-align:center!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; display:block!important; text-decoration:none!important; background:none!important">?</a></span></div><br><table border="0" cellpadding="0" cellspacing="0" style="width:704px; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><tbody style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><tr style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><td class="gutter" style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; min-height:auto!important; color:rgb(175,175,175)!important; background:none!important"><br><div class="line number1 index0 alt2" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>1</div><br><div class="line number2 index1 alt1" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>2</div><br><div class="line number3 index2 alt2" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>3</div><br></td><br><td class="code" style="width:675px; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><div class="container" style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:relative!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><div class="line number1 index0 alt2" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&lt;networkConnectors&gt;</code></div><br><div class="line number2 index1 alt1" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java spaces" style="color:red; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&lt;networkConnector<br> uri=</code><code class="java string" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; color:blue!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&quot;static:(tcp://localhost:61616)&quot;</code><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">/&gt;</code></div><br><div class="line number3 index2 alt2" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&lt;/networkConnectors&gt;</code></div><br></div><br></td><br></tr><br></tbody><br></table><br></div><br></div><br><div style="padding:0px; margin:0px; color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体; font-size:12.5px; line-height:22.5px"><br><div id="highlighter_351396" class="syntaxhighlighter  java" style="padding:0px; width:704px; margin:1em 0px!important; position:relative!important; overflow:auto!important; font-size:1em!important"><br><div class="toolbar" style="padding:0px!important; margin:0px!important; border:none!important; bottom:auto!important; float:none!important; height:11px!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:absolute!important; right:1px!important; top:1px!important; vertical-align:baseline!important; width:11px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:10px!important; min-height:auto!important; z-index:10!important; color:white!important; background:rgb(108,226,108)!important"><br><span style="padding:0px; margin:0px"><a target="_blank" href="http://my.oschina.net/OutOfMemory/blog/596552#" class="toolbar_item command_help help" style="padding:1px 0px 0px!important; margin:0px!important; color:white!important; outline:0px!important; font-size:1em!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; overflow:visible!important; position:static!important; right:auto!important; text-align:center!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; display:block!important; text-decoration:none!important; background:none!important">?</a></span></div><br><table border="0" cellpadding="0" cellspacing="0" style="width:1024px; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><tbody style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><tr style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><td class="gutter" style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; min-height:auto!important; color:rgb(175,175,175)!important; background:none!important"><br><div class="line number1 index0 alt2" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>1</div><br><div class="line number2 index1 alt1" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>2</div><br><div class="line number3 index2 alt2" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>3</div><br></td><br><td class="code" style="width:995px; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><div class="container" style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:relative!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><div class="line number1 index0 alt2" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&lt;transportConnectors&gt;</code></div><br><div class="line number2 index1 alt1" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java spaces" style="color:red; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&lt;transportConnector<br> name=</code><code class="java string" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; color:blue!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&quot;openwire&quot;</code><br><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br>uri=</code><code class="java string" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; color:blue!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&quot;tcp://0.0.0.0:61617?maximumConnectio&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br> ns=1000&amp;amp;wireFormat.maxFrameSize=104857600&quot;</code><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">/&gt;</code></div><br><div class="line number3 index2 alt2" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java spaces" style="color:red; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&nbsp;</code><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&lt;/transportConnectors&gt;</code></div><br></div><br></td><br></tr><br></tbody><br></table><br></div><br></div><br><span style="color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体; font-size:12.5px; line-height:22.5px">通过以上配置使M1和M2这两个&nbsp;</span><span style="padding:0px; margin:0px; color:rgb(51,51,51); font-family:'Microsoft YaHei',微软雅黑,Arial,'Lucida Grande',Tahoma,sans-serif; font-size:13px; line-height:24.05px">broker通过网络互相连接，并共享queue，<br style="padding:0px; margin:0px"><br>启动M1和M2,可以看到如下启动日志：</span><span style="color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体; font-size:12.5px; line-height:22.5px">&nbsp;</span><span style="padding:0px; margin:0px; color:rgb(51,51,51); font-size:13px; line-height:24.05px; font-family:'Microsoft YaHei',微软雅黑,Arial,'Lucida Grande',Tahoma,sans-serif"><br style="padding:0px; margin:0px"><br><a target="_blank" href="http://static.oschina.net/uploads/space/2016/0103/194536_ySvR_159239.png" style="padding:0px; margin:0px; color:rgb(255,131,115); outline:0px; font-size:12px"><img src="http://static.oschina.net/uploads/space/2016/0103/194536_ySvR_159239.png" alt="" style="padding:0px; margin:10px 0px; border:1px solid rgb(221,221,221); max-width:640px; background:rgb(244,247,249)"></a><br style="padding:0px; margin:0px"><br></span><span style="color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体; font-size:12.5px; line-height:22.5px"></span><br><p style="padding-top:0px; padding-bottom:0px; margin-top:8px; margin-bottom:8px; line-height:22.5px; letter-spacing:0.5px; font-size:12.5px; word-wrap:break-word; word-break:break-all; color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体"><br><span style="padding:0px; margin:0px"><span style="padding:0px; margin:0px; font-size:13px; line-height:24.05px"><a target="_blank" href="http://static.oschina.net/uploads/space/2016/0103/194609_AlHc_159239.png" style="padding:0px; margin:0px; color:rgb(255,131,115); outline:0px; font-size:12px"><img src="http://static.oschina.net/uploads/space/2016/0103/194609_AlHc_159239.png" alt="" style="padding:0px; margin:10px 0px; border:1px solid rgb(221,221,221); max-width:640px; background:rgb(244,247,249)"></a><br style="padding:0px; margin:0px"><br></span></span></p><br><p style="padding-top:0px; padding-bottom:0px; margin-top:8px; margin-bottom:8px; line-height:22.5px; letter-spacing:0.5px; font-size:12.5px; word-wrap:break-word; word-break:break-all; color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体"><br><span style="padding:0px; margin:0px"><span style="padding:0px; margin:0px; font-size:13px; line-height:24.05px">可以看到M1和M2，<span style="padding:0px; margin:0px; color:rgb(76,51,229)">network connection has been established</span></span></span></p><br><p style="padding-top:0px; padding-bottom:0px; margin-top:8px; margin-bottom:8px; line-height:22.5px; letter-spacing:0.5px; font-size:12.5px; word-wrap:break-word; word-break:break-all; color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体"><br><span style="padding:0px; margin:0px"><span style="padding:0px; margin:0px; font-size:13px; line-height:24.05px"><span style="padding:0px; margin:0px; color:rgb(76,51,229)"><span style="padding:0px; margin:0px; color:rgb(0,0,0)">测试我们还是用上一篇中的Sender和Receiver类，只需要做一点点修改：<br style="padding:0px; margin:0px"><br></span><span style="padding:0px; margin:0px; color:rgb(0,0,0)">Sender类还是链接tcp://localhost:61616，发送消息到queue，<br style="padding:0px; margin:0px"><br>Receiver做如下修改:<br style="padding:0px; margin:0px"><br></span></span></span></span></p><br><div style="padding:0px; margin:0px; color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体; font-size:12.5px; line-height:22.5px"><br><div id="highlighter_256279" class="syntaxhighlighter  java" style="padding:0px; width:704px; margin:1em 0px!important; position:relative!important; overflow:auto!important; font-size:1em!important"><br><div class="toolbar" style="padding:0px!important; margin:0px!important; border:none!important; bottom:auto!important; float:none!important; height:11px!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:absolute!important; right:1px!important; top:1px!important; vertical-align:baseline!important; width:11px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:10px!important; min-height:auto!important; z-index:10!important; color:white!important; background:rgb(108,226,108)!important"><br><span style="padding:0px; margin:0px"><a target="_blank" href="http://my.oschina.net/OutOfMemory/blog/596552#" class="toolbar_item command_help help" style="padding:1px 0px 0px!important; margin:0px!important; color:white!important; outline:0px!important; font-size:1em!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; overflow:visible!important; position:static!important; right:auto!important; text-align:center!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; display:block!important; text-decoration:none!important; background:none!important">?</a></span></div><br><table border="0" cellpadding="0" cellspacing="0" style="width:704px; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><tbody style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><tr style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><td class="gutter" style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; min-height:auto!important; color:rgb(175,175,175)!important; background:none!important"><br><div class="line number1 index0 alt2" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>1</div><br><div class="line number2 index1 alt1" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>2</div><br><div class="line number3 index2 alt2" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>3</div><br></td><br><td class="code" style="width:675px; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><div class="container" style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:relative!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><div class="line number1 index0 alt2" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">connectionFactory<br> = </code><code class="java keyword" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; color:rgb(0,102,153)!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-weight:bold!important; font-size:1em!important; min-height:auto!important; background:none!important">new</code><br><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br>ActiveMQConnectionFactory(</code></div><br><div class="line number2 index1 alt1" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java spaces" style="color:red; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">ActiveMQConnection.DEFAULT_USER,</code></div><br><div class="line number3 index2 alt2" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java spaces" style="color:red; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">ActiveMQConnection.DEFAULT_PASSWORD,<br></code><code class="java string" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; color:blue!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&quot;tcp://localhost:61617&quot;</code><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">);</code></div><br></div><br></td><br></tr><br></tbody><br></table><br></div><br></div><br><p style="padding-top:0px; padding-bottom:0px; margin-top:8px; margin-bottom:8px; line-height:22.5px; letter-spacing:0.5px; font-size:12.5px; word-wrap:break-word; word-break:break-all; color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体"><br>经测试Receiver可以接受到数据，表示M1和M2已经共享了queue</p><br><p style="padding-top:0px; padding-bottom:0px; margin-top:8px; margin-bottom:8px; line-height:22.5px; letter-spacing:0.5px; font-size:12.5px; word-wrap:break-word; word-break:break-all; color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体"><br><span style="padding:0px; margin:0px"><span style="padding:0px; margin:0px; font-size:13px; line-height:24.05px"><span style="padding:0px; margin:0px; color:rgb(76,51,229)">2).<span style="padding:0px; margin:0px; font-family:'Microsoft YaHei',微软雅黑,Arial,'Lucida Grande',Tahoma,sans-serif; line-height:24.05px">Dynamic<br> Broker-Cluster</span></span></span></span></p><br><p style="padding-top:0px; padding-bottom:0px; margin-top:8px; margin-bottom:8px; line-height:22.5px; letter-spacing:0.5px; font-size:12.5px; word-wrap:break-word; word-break:break-all; color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体"><br><span style="padding:0px; margin:0px"><span style="padding:0px; margin:0px; font-size:13px; line-height:24.05px"><span style="padding:0px; margin:0px; color:rgb(76,51,229)"><span style="padding:0px; margin:0px; font-family:'Microsoft YaHei',微软雅黑,Arial,'Lucida Grande',Tahoma,sans-serif; line-height:24.05px"><span style="padding:0px; margin:0px; color:rgb(0,0,0)">Dynamic<br> Discovery集群方式在配置ActiveMQ实例时，不需要知道所有其它实例的URI地址</span><span style="padding:0px; margin:0px; color:rgb(0,0,0)"><br style="padding:0px; margin:0px"><br></span><span style="padding:0px; margin:0px; color:rgb(0,0,0)">对activemq.xml做如下配置:<br style="padding:0px; margin:0px"><br><span style="padding:0px; margin:0px; line-height:24.05px">M1做如下配置:<br style="padding:0px; margin:0px"><br></span></span></span></span></span></span></p><br><div style="padding:0px; margin:0px; color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体; font-size:12.5px; line-height:22.5px"><br><div id="highlighter_464186" class="syntaxhighlighter  java" style="padding:0px; width:704px; margin:1em 0px!important; position:relative!important; overflow:auto!important; font-size:1em!important"><br><div class="toolbar" style="padding:0px!important; margin:0px!important; border:none!important; bottom:auto!important; float:none!important; height:11px!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:absolute!important; right:1px!important; top:1px!important; vertical-align:baseline!important; width:11px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:10px!important; min-height:auto!important; z-index:10!important; color:white!important; background:rgb(108,226,108)!important"><br><span style="padding:0px; margin:0px"><a target="_blank" href="http://my.oschina.net/OutOfMemory/blog/596552#" class="toolbar_item command_help help" style="padding:1px 0px 0px!important; margin:0px!important; color:white!important; outline:0px!important; font-size:1em!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; overflow:visible!important; position:static!important; right:auto!important; text-align:center!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; display:block!important; text-decoration:none!important; background:none!important">?</a></span></div><br><table border="0" cellpadding="0" cellspacing="0" style="width:704px; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><tbody style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><tr style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><td class="gutter" style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; min-height:auto!important; color:rgb(175,175,175)!important; background:none!important"><br><div class="line number1 index0 alt2" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>1</div><br><div class="line number2 index1 alt1" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>2</div><br><div class="line number3 index2 alt2" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>3</div><br></td><br><td class="code" style="width:675px; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><div class="container" style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:relative!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><div class="line number1 index0 alt2" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&lt;networkConnectors&gt;</code></div><br><div class="line number2 index1 alt1" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java spaces" style="color:red; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&lt;networkConnector<br> uri=</code><code class="java string" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; color:blue!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&quot;multicast://default&quot;</code><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">/&gt;</code></div><br><div class="line number3 index2 alt2" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&lt;/networkConnectors&gt;</code></div><br></div><br></td><br></tr><br></tbody><br></table><br></div><br></div><br><div style="padding:0px; margin:0px; color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体; font-size:12.5px; line-height:22.5px"><br><div id="highlighter_579267" class="syntaxhighlighter  java" style="padding:0px; width:704px; margin:1em 0px!important; position:relative!important; overflow:auto!important; font-size:1em!important"><br><div class="toolbar" style="padding:0px!important; margin:0px!important; border:none!important; bottom:auto!important; float:none!important; height:11px!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:absolute!important; right:1px!important; top:1px!important; vertical-align:baseline!important; width:11px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:10px!important; min-height:auto!important; z-index:10!important; color:white!important; background:rgb(108,226,108)!important"><br><span style="padding:0px; margin:0px"><a target="_blank" href="http://my.oschina.net/OutOfMemory/blog/596552#" class="toolbar_item command_help help" style="padding:1px 0px 0px!important; margin:0px!important; color:white!important; outline:0px!important; font-size:1em!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; overflow:visible!important; position:static!important; right:auto!important; text-align:center!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; display:block!important; text-decoration:none!important; background:none!important">?</a></span></div><br><table border="0" cellpadding="0" cellspacing="0" style="width:962px; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><tbody style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><tr style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><td class="gutter" style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; min-height:auto!important; color:rgb(175,175,175)!important; background:none!important"><br><div class="line number1 index0 alt2" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>1</div><br><div class="line number2 index1 alt1" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>2</div><br><div class="line number3 index2 alt2" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>3</div><br><div class="line number4 index3 alt1" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>4</div><br></td><br><td class="code" style="width:933px; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><div class="container" style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:relative!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><div class="line number1 index0 alt2" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&lt;transportConnectors&gt;</code></div><br><div class="line number2 index1 alt1" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java spaces" style="color:red; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&lt;transportConnector<br> name=</code><code class="java string" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; color:blue!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&quot;openwire&quot;</code><br><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br>uri=</code><code class="java string" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; color:blue!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&quot;tcp://0.0.0.0:61616?<br> maximumConnections=1000&amp;amp;wireFormat.maxFrameSize=104857600&quot;</code></div><br><div class="line number3 index2 alt2" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java spaces" style="color:red; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">discoveryUri=</code><code class="java string" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; color:blue!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&quot;multicast://default&quot;</code><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">/&gt;</code></div><br><div class="line number4 index3 alt1" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java spaces" style="color:red; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&nbsp;</code><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&lt;/transportConnectors&gt;</code></div><br></div><br></td><br></tr><br></tbody><br></table><br></div><br></div><br><span style="padding:0px; margin:0px; color:rgb(51,51,51); font-family:'Microsoft YaHei',微软雅黑,Arial,'Lucida Grande',Tahoma,sans-serif; font-size:13px; line-height:24.05px">M2<span style="padding:0px; margin:0px; line-height:24.05px">做如下配置:</span></span><span style="color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体; font-size:12.5px; line-height:22.5px"></span><br><div style="padding:0px; margin:0px; color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体; font-size:12.5px; line-height:22.5px"><br><div id="highlighter_377292" class="syntaxhighlighter  java" style="padding:0px; width:704px; margin:1em 0px!important; position:relative!important; overflow:auto!important; font-size:1em!important"><br><div class="toolbar" style="padding:0px!important; margin:0px!important; border:none!important; bottom:auto!important; float:none!important; height:11px!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:absolute!important; right:1px!important; top:1px!important; vertical-align:baseline!important; width:11px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:10px!important; min-height:auto!important; z-index:10!important; color:white!important; background:rgb(108,226,108)!important"><br><span style="padding:0px; margin:0px"><a target="_blank" href="http://my.oschina.net/OutOfMemory/blog/596552#" class="toolbar_item command_help help" style="padding:1px 0px 0px!important; margin:0px!important; color:white!important; outline:0px!important; font-size:1em!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; overflow:visible!important; position:static!important; right:auto!important; text-align:center!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; display:block!important; text-decoration:none!important; background:none!important">?</a></span></div><br><table border="0" cellpadding="0" cellspacing="0" style="width:704px; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><tbody style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><tr style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><td class="gutter" style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; min-height:auto!important; color:rgb(175,175,175)!important; background:none!important"><br><div class="line number1 index0 alt2" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>1</div><br><div class="line number2 index1 alt1" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>2</div><br><div class="line number3 index2 alt2" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>3</div><br></td><br><td class="code" style="width:675px; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><div class="container" style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:relative!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><div class="line number1 index0 alt2" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&lt;networkConnectors&gt;</code></div><br><div class="line number2 index1 alt1" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java spaces" style="color:red; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&lt;networkConnector<br> uri=</code><code class="java string" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; color:blue!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&quot;multicast://default&quot;</code><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">/&gt;</code></div><br><div class="line number3 index2 alt2" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&lt;/networkConnectors&gt;</code></div><br></div><br></td><br></tr><br></tbody><br></table><br></div><br></div><br><div style="padding:0px; margin:0px; color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体; font-size:12.5px; line-height:22.5px"><br><div id="highlighter_494719" class="syntaxhighlighter  java" style="padding:0px; width:704px; margin:1em 0px!important; position:relative!important; overflow:auto!important; font-size:1em!important"><br><div class="toolbar" style="padding:0px!important; margin:0px!important; border:none!important; bottom:auto!important; float:none!important; height:11px!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:absolute!important; right:1px!important; top:1px!important; vertical-align:baseline!important; width:11px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:10px!important; min-height:auto!important; z-index:10!important; color:white!important; background:rgb(108,226,108)!important"><br><span style="padding:0px; margin:0px"><a target="_blank" href="http://my.oschina.net/OutOfMemory/blog/596552#" class="toolbar_item command_help help" style="padding:1px 0px 0px!important; margin:0px!important; color:white!important; outline:0px!important; font-size:1em!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; overflow:visible!important; position:static!important; right:auto!important; text-align:center!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; display:block!important; text-decoration:none!important; background:none!important">?</a></span></div><br><table border="0" cellpadding="0" cellspacing="0" style="width:962px; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><tbody style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><tr style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><td class="gutter" style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:1em!important; min-height:auto!important; color:rgb(175,175,175)!important; background:none!important"><br><div class="line number1 index0 alt2" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>1</div><br><div class="line number2 index1 alt1" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>2</div><br><div class="line number3 index2 alt2" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>3</div><br><div class="line number4 index3 alt1" style="padding:0px 0.5em 0px 1em!important; margin:0px!important; border-width:0px 3px 0px 0px!important; border-right-style:solid!important; border-right-color:rgb(108,226,108)!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; text-align:right!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br>4</div><br></td><br><td class="code" style="width:933px; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><div class="container" style="padding:0px!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:relative!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br><div class="line number1 index0 alt2" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&lt;transportConnectors&gt;</code></div><br><div class="line number2 index1 alt1" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java spaces" style="color:red; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&lt;transportConnector<br> name=</code><code class="java string" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; color:blue!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&quot;openwire&quot;</code><br><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important"><br>uri=</code><code class="java string" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; color:blue!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&quot;tcp://0.0.0.0:61617?<br> maximumConnections=1000&amp;amp;wireFormat.maxFrameSize=104857600&quot;</code></div><br><div class="line number3 index2 alt2" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java spaces" style="color:red; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">discoveryUri=</code><code class="java string" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; color:blue!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&quot;multicast://default&quot;</code><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">/&gt;</code></div><br><div class="line number4 index3 alt1" style="padding:0px 1em!important; margin:0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; white-space:pre!important"><br><code class="java spaces" style="color:red; padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&nbsp;</code><code class="java plain" style="padding:0px!important; margin:0px!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:1.1em!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; font-size:1em!important; min-height:auto!important; background:none!important">&lt;/transportConnectors&gt;</code></div><br></div><br></td><br></tr><br></tbody><br></table><br></div><br></div><br><span style="padding:0px; margin:0px; color:rgb(51,51,51); font-family:'Microsoft YaHei',微软雅黑,Arial,'Lucida Grande',Tahoma,sans-serif; font-size:13px; line-height:24.05px">启动M1和M2,可以看到如下启动日志：</span><span style="color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体; font-size:12.5px; line-height:22.5px">&nbsp;</span><span style="padding:0px; margin:0px; font-family:'Microsoft YaHei',Verdana,sans-serif,宋体; color:rgb(76,51,229); font-size:13px; line-height:24.05px">network<br> connection has been established</span><span style="color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体; font-size:12.5px; line-height:22.5px"></span><span style="padding:0px; margin:0px; color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体; font-size:12.5px; line-height:22.5px"></span><span style="color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体; font-size:12.5px; line-height:22.5px"></span><br><p style="padding-top:0px; padding-bottom:0px; margin-top:8px; margin-bottom:8px; line-height:22.5px; letter-spacing:0.5px; font-size:12.5px; word-wrap:break-word; word-break:break-all; color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体"><br>测试同static broker-cluster,可以得到相同的结果。<br style="padding:0px; margin:0px"><br>官网配置说明：<a target="_blank" href="http://activemq.apache.org/networks-of-brokers.html" rel="nofollow" style="padding:0px; margin:0px; color:rgb(255,131,115); outline:0px; font-size:12px">http://activemq.apache.org/networks-of-brokers.html</a></p><br><p style="padding-top:0px; padding-bottom:0px; margin-top:8px; margin-bottom:8px; line-height:22.5px; letter-spacing:0.5px; font-size:12.5px; word-wrap:break-word; word-break:break-all; color:rgb(51,51,51); font-family:'Microsoft YaHei',Verdana,sans-serif,宋体"><br>Master-Slaver保证了数据的可靠性，Broker-Cluster提供了负载均衡，所以一般正式环境中都会采用：<br style="padding:0px; margin:0px"><br><span style="padding:0px; margin:0px">Master-Slaver&#43;</span><span style="padding:0px; margin:0px">Broker-Cluster的模式</span></p><br><br><br></div>

<p></p></div><p></p>
<!-- Baidu Button BEGIN -->
<div class="bdsharebuttonbox tracking-ad" style="float: right;" data-mod="popu_172"><br><a href="#" class="bds_more" data-cmd="more" style="background-position:0 0 !important; background-image: url(http://bdimg.share.baidu.com/static/api/img/share/icons_0_16.png?v=d754dcc0.png) !important"></a><br><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间" style="background-position:0 -52px !important"></a><br><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博" style="background-position:0 -104px !important"></a><br><a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博" style="background-position:0 -260px !important"></a><br><a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网" style="background-position:0 -208px !important"></a><br><a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信" style="background-position:0 -1612px !important"></a><br></div><br><script>window._bd_share_config = { “common”: { “bdSnsKey”: {}, “bdText”: “”, “bdMini”: “1”, “bdMiniList”: false, “bdPic”: “”, “bdStyle”: “0”, “bdSize”: “16” }, “share”: {} }; with (document) 0[(getElementsByTagName(‘head’)[0] || body).appendChild(createElement(‘script’)).src = ‘<a href="http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion=">http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion=</a>‘ + ~(-new Date() / 36e5)];</script><br><!-- Baidu Button END --><br><br><br><br><br><!--172.16.140.12--><br><br><!-- Baidu Button BEGIN --><br><script type="text/javascript" id="bdshare_js" data="type=tools&amp;uid=1536434"></script><br><script type="text/javascript" id="bdshell_js"></script><br><script type="text/javascript"><br>    document.getElementById(“bdshell_js”).src = “<a href="http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=">http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=</a>“ + Math.ceil(new Date()/3600000)<br></script><br><!-- Baidu Button END --><br><br><br><br><br><br><br>        <div id="digg" articleid="51241597"><br>            <dl id="btnDigg" class="digg digg_disable" onclick="btndigga();"><br><br>                 <dt>顶</dt><br>                <dd>3</dd><br>            </dl><br><br><br>            <dl id="btnBury" class="digg digg_disable" onclick="btnburya();"><br><br>                  <dt>踩</dt><br>                <dd>0</dd><br>            </dl><br><br>        </div><br>     <div class="tracking-ad" data-mod="popu_222"><a href="javascript:void(0);" target="_blank" rel="external">&nbsp;</a>   </div><br>    <div class="tracking-ad" data-mod="popu_223"> <a href="javascript:void(0);" target="_blank" rel="external">&nbsp;</a></div><br>    <script type="text/javascript"><br>                function btndigga() {<br>                    $(“.tracking-ad[data-mod=’popu_222’] a”).click();<br>                }<br>                function btnburya() {<br>                    $(“.tracking-ad[data-mod=’popu_223’] a”).click();<br>                }<br>            </script><br><br>   <ul class="article_next_prev"><br>                <li class="prev_article"><span onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_shangyipian']);location.href='/he90227/article/details/51163822';">上一篇</span><a href="/he90227/article/details/51163822" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_shangyipian'])">多线程笔记</a></li><br>                <li class="next_article"><span onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_xiayipian']);location.href='/he90227/article/details/51248063';">下一篇</span><a href="/he90227/article/details/51248063" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_xiayipian'])">亿级Web系统搭建——单机到分布式集群</a></li><br>    </ul><br><br>    <div style="clear:both; height:10px;"></div>


<pre><code>&lt;div class=&quot;similar_article&quot;   &gt;
        &lt;h4&gt;&lt;/h4&gt;
        &lt;div class=&quot;similar_c&quot;style=&quot;margin:20px 0px 0px 0px&quot;&gt;
            &lt;div class=&quot;similar_c_t&quot;&gt;
              &amp;nbsp;&amp;nbsp;相关文章推荐
            &lt;/div&gt;

            &lt;div class=&quot;similar_wrap tracking-ad&quot; data-mod=&quot;popu_36&quot;  style=&quot;max-height:195px;&quot;&gt;                       
                &lt;ul class=&quot;similar_list fl&quot;&gt;    
                       &lt;li&gt;
                           &lt;em&gt;•&lt;/em&gt;
                           &lt;a href=&quot;http://blog.csdn.net/lee1991723/article/details/48268861&quot; title=&quot;Spring整合JMS(一)——基于ActiveMQ实现&quot; strategy=&quot;&quot; target=&quot;_blank&quot; style=&quot;width: 290px;&quot;&gt;Spring整合JMS(一)——基于ActiveMQ实现&lt;/a&gt;
                       &lt;/li&gt;
                       &lt;li&gt;
                           &lt;em&gt;•&lt;/em&gt;
                           &lt;a href=&quot;http://blog.csdn.net/zwk626542417/article/details/48063383&quot; title=&quot;Spring整合JMS(一)——基于ActiveMQ实现&quot; strategy=&quot;&quot; target=&quot;_blank&quot; style=&quot;width: 290px;&quot;&gt;Spring整合JMS(一)——基于ActiveMQ实现&lt;/a&gt;
                       &lt;/li&gt;
                       &lt;li&gt;
                           &lt;em&gt;•&lt;/em&gt;
                           &lt;a href=&quot;http://blog.csdn.net/u010961759/article/details/39293649&quot; title=&quot;Spring整合JMS(一)——基于ActiveMQ实现&quot; strategy=&quot;&quot; target=&quot;_blank&quot; style=&quot;width: 290px;&quot;&gt;Spring整合JMS(一)——基于ActiveMQ实现&lt;/a&gt;
                       &lt;/li&gt;
                       &lt;li&gt;
                           &lt;em&gt;•&lt;/em&gt;
                           &lt;a href=&quot;http://blog.csdn.net/lingyun870801/article/details/23991513&quot; title=&quot;ActiveMQ整合Spring实现消息机制二(消息接收端配置)&quot; strategy=&quot;&quot; target=&quot;_blank&quot; style=&quot;width: 290px;&quot;&gt;ActiveMQ整合Spring实现消息机制二(消息接收端配置)&lt;/a&gt;
                       &lt;/li&gt;
                       &lt;li&gt;
                           &lt;em&gt;•&lt;/em&gt;
                           &lt;a href=&quot;http://blog.csdn.net/u014756827/article/details/52449232&quot; title=&quot;深入浅出JMS(四)--Spring和ActiveMQ整合的完整实例&quot; strategy=&quot;&quot; target=&quot;_blank&quot; style=&quot;width: 290px;&quot;&gt;深入浅出JMS(四)--Spring和ActiveMQ整合的完整实例&lt;/a&gt;
                       &lt;/li&gt;
                &lt;/ul&gt;
                  &lt;ul class=&quot;similar_list fr&quot;&gt;      
                       &lt;li&gt;
                           &lt;em&gt;•&lt;/em&gt;
                           &lt;a href=&quot;http://blog.csdn.net/jianfpeng241241/article/details/51678695&quot; title=&quot;JMS学习(4):--Spring和ActiveMQ整合的完整实例&quot; strategy=&quot;&quot; target=&quot;_blank&quot; style=&quot;width: 290px;&quot;&gt;JMS学习(4):--Spring和ActiveMQ整合的完整实例&lt;/a&gt;
                       &lt;/li&gt;
                       &lt;li&gt;
                           &lt;em&gt;•&lt;/em&gt;
                           &lt;a href=&quot;http://blog.csdn.net/jingqiang521/article/details/49047847&quot; title=&quot;4、深入浅出JMS(四)--Spring和ActiveMQ整合的完整实例&quot; strategy=&quot;&quot; target=&quot;_blank&quot; style=&quot;width: 290px;&quot;&gt;4、深入浅出JMS(四)--Spring和ActiveMQ整合的完整实例&lt;/a&gt;
                       &lt;/li&gt;
                       &lt;li&gt;
                           &lt;em&gt;•&lt;/em&gt;
                           &lt;a href=&quot;http://blog.csdn.net/Leonardo9029/article/details/43154385&quot; title=&quot;浅谈jms之（通过spring整合activeMQ实现jms）实例&quot; strategy=&quot;&quot; target=&quot;_blank&quot; style=&quot;width: 290px;&quot;&gt;浅谈jms之（通过spring整合activeMQ实现jms）实例&lt;/a&gt;
                       &lt;/li&gt;
                       &lt;li&gt;
                           &lt;em&gt;•&lt;/em&gt;
                           &lt;a href=&quot;http://blog.csdn.net/yinbucheng/article/details/72477543&quot; title=&quot;spring整合activeMQ&quot; strategy=&quot;&quot; target=&quot;_blank&quot; style=&quot;width: 290px;&quot;&gt;spring整合activeMQ&lt;/a&gt;
                       &lt;/li&gt;
                       &lt;li&gt;
                           &lt;em&gt;•&lt;/em&gt;
                           &lt;a href=&quot;http://blog.csdn.net/polo_longsan/article/details/52317966&quot; title=&quot;ActiveMQ与Spring整合:(1)基本使用&quot; strategy=&quot;&quot; target=&quot;_blank&quot; style=&quot;width: 290px;&quot;&gt;ActiveMQ与Spring整合:(1)基本使用&lt;/a&gt;
                       &lt;/li&gt;
                &lt;/ul&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;   
</code></pre><p></p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/06/13/disruptor-01/" rel="next" title="Disruptor入门">
                <i class="fa fa-chevron-left"></i> Disruptor入门
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/06/14/activemq-02/" rel="prev" title="Spring整合ActiveMQ 事务管理">
                Spring整合ActiveMQ 事务管理 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Inhaltsverzeichnis
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Übersicht
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://bloodorange2017.github.io/images/img_head_001.jpg"
               alt="XueCheng" />
          <p class="site-author-name" itemprop="name">XueCheng</p>
           
              <p class="site-description motion-element" itemprop="description">Do one thing at a time, and do well.</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">37</span>
                <span class="site-state-item-name">Artikel</span>
              </a>
            </div>
          

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#undefined"><span class="nav-number">1.</span> <span class="nav-text">1.管理ActiveMQ</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#undefined"><span class="nav-number">2.</span> <span class="nav-text">2.Spring整合ActiveMQ</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#undefined"><span class="nav-number">2.1.</span> <span class="nav-text">   1.maven</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#undefined"><span class="nav-number">2.2.</span> <span class="nav-text">   2.ActiveMQ配置文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#undefined"><span class="nav-number">2.3.</span> <span class="nav-text">3.生产者</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#undefined"><span class="nav-number">2.3.1.</span> <span class="nav-text">1.queue消息队列模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#undefined"><span class="nav-number">2.3.2.</span> <span class="nav-text">2. topic/sub订阅模式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#undefined"><span class="nav-number">2.4.</span> <span class="nav-text">4.消费者</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#undefined"><span class="nav-number">2.4.1.</span> <span class="nav-text">1.queue消息队列模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#undefined"><span class="nav-number">2.4.2.</span> <span class="nav-text">2.topic/sub订阅模式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#undefined"><span class="nav-number">2.5.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#undefined"><span class="nav-number">2.6.</span> <span class="nav-text">5.Controller</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#undefined"><span class="nav-number">3.</span> <span class="nav-text">3.ActiveMQ的多种部署方式</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#undefined"><span class="nav-number">3.0.0.0.1.</span> <span class="nav-text">1、Master-Slave部署方式</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#undefined"><span class="nav-number">3.0.0.0.1.1.</span> <span class="nav-text">1）shared filesystem Master-Slave部署方式</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#undefined"><span class="nav-number">3.0.0.0.1.2.</span> <span class="nav-text">2）shared database Master-Slave方式</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#undefined"><span class="nav-number">3.0.0.0.1.3.</span> <span class="nav-text">3）Replicated LevelDB Store方式</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#undefined"><span class="nav-number">3.0.0.0.2.</span> <span class="nav-text">2、Broker-Cluster部署方式</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#undefined"><span class="nav-number">3.0.0.0.2.1.</span> <span class="nav-text">1）static Broker-Cluster部署</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#undefined"><span class="nav-number">3.0.0.0.2.2.</span> <span class="nav-text">2）Dynamic Broker-Cluster部署</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#undefined"><span class="nav-number">3.0.0.0.3.</span> <span class="nav-text">2、Master-Slave与Broker-Cluster相结合的部署方式</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#undefined"><span class="nav-number">3.0.0.0.3.1.</span> <span class="nav-text">1、部署的配置修改</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#undefined"><span class="nav-number">4.</span> <span class="nav-text">4.ActiveMQ之Master-Slaver+负载均衡</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#undefined"><span class="nav-number">5.</span> <span class="nav-text">5.Broker-Cluster实现负载均衡</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#undefined"><span class="nav-number">6.</span> <span class="nav-text">5.Broker-Cluster实现负载均衡</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">XueCheng</span>
</div>


<div class="powered-by">
  Erstellt mit  <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  





  

  

  

  

  

<script type="text/javascript"
color="160,160,233" opacity='0.4' zIndex="-2" count="16" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
</body>
</html>
